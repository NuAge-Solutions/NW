"use strict";OJ.extendClass("NwManager",[OjActionable],{_namespace:"nw",_comm:function(b,a){return NW.comm(this._namespace+"."+b,a)}});OJ.definePackage("Nw",{_g_p_:{isNative:false,isReady:false,userHttp:false,keyboardVisible:false,version:0},_scroll_top:0,_scroll_left:0,BACKGROUND_FETCH:"nwOnAppFetch",CONFIRM:"nwConfirm",STATUS_BAR_CHANGE:"onStatusBarChange",STATUS_BAR_NONE:-1,STATUS_BAR_DEFAULT:0,STATUS_BAR_BLACK_TRANSLUCENT:1,STATUS_BAR_BLACK_OPAQUE:2,PORTRAIT:1,PORTRAIT_UPSIDE_DOWN:2,LANDSCAPE_LEFT:3,LANDSCAPE_RIGHT:4,_call:function(b,d){var a;if(isFunction(this[b])){b=(a=this)[b]}else{var c=b.split(".");if(c.length==1){a=window}else{c.pop();a=OJ.stringToVar(c)}b=OJ.stringToVar(b)}if(a&&isFunction(b)){return toJson(OjObject.exportData(b.apply(a,d?d:[])))}return null},_comm:function(a,d,c){if(!d){d=[]}if(!c){c=true}var j="nw",b=window,g=0,f=OJ.os,e;if(f==OJ.IOS||f==OJ.OSX){b=window.webkit.messageHandlers[j];j=b.postMessage;d=[[a,d]]}else{e=a.split(".");for(var h=e.length;g<h;g++){b=b[j];j=b[e[g]]}}if(c){return setTimeout(function(){j.apply(b,d)},1)}return j.apply(b,d)},_onNativeReady:function(){var a=this.comm("nw.ready");this._isReady=true;this.dispatchEvent(new OjEvent(OjEvent.READY));return a},_triggerEvent:function(a,b){this.dispatchEvent(new NwEvent(a,false,false,b))},_onKeyboardHide:function(a){var b=this;b._keyboardVisible=false;OJ.scroll_top=b._scroll_top;OJ.scrol_left=b._scroll_left},_onKeyboardShow:function(a){var b=this;if(!b._keyboardVisible){b._scroll_top=OJ.scroll_top;b._scroll_left=OJ.scroll_left}b._keyboardVisible=true},_onOrientationChange:function(a){var b=OjOrientationEvent},comm:function(){},"=isNative":function(a){if(arguments.length){if(this._isNative=!isEmpty(this._gateway=a)){OJ.addCss("is-native");this.comm=this._comm;if(OJ.is_ready){this._onNativeReady()}document.documentElement.style.webkitTouchCallout=document.body.style.webkitTouchCallout=document.body.style.KhtmlUserSelect="none";document.documentElement.style.webkitTapHighlightColor="rgba(0,0,0,0)"}else{this.comm=function(){}}}},notify:function(c,b,a){this.comm("nw.notify",arguments,true)},log:function(a){return this.comm("nw.log",[a])},logTimed:function(a,b){},_onOjLoad:function(a){this._s(OjPackage,"_onOjLoad",arguments);var b=HistoryManager.get();this.isNative=(b.host=="native.web")?b.getQueryParam("nw-gateway"):window.__nw_gateway_id__},_onOjReady:function(a){this._s(OjPackage,"_onOjReady",arguments);if(this.isNative){this._onNativeReady()}else{OJ.addEventListener(OjOrientationEvent.CHANGE,this,"_onOrientationChange")}},".gateway":function(){return this._gateway},".maxSize":function(){return this.comm("nw.maxSize")},"=maxSize":function(b,a){return this.comm("nw.maxSize",[b,a])},".minSize":function(){return this.comm("nw.minSize")},"=minSize":function(b,a){this.comm("nw.minSize",[b,a])},".statusBarStyle":function(){return this.comm("nw.statusBarStyle")},"=statusBarStyle":function(a){this.comm("nw.statusBarStyle",[a])},".supportedOrientations":function(){return this.comm("nw.supportedOrientations")},"=supportedOrientations":function(a){this.comm("nw.supportedOrientations",[a])}});OJ.extendClass("NwDataEvent",[OjEvent],{_g_p_:{data:null,oldData:null},_c:function(c){var b,a=b=false,d=arguments.length;if(d>1){this._data=arguments[1];if(d>2){this._oldData=arguments[2];if(d>3){a=arguments[3];if(d>4){b=arguments[4]}}}}this._s(OjEvent,"_c",[c,a,b])}},{CHANGE:"onDataChange",DELETE:"onDataDelete",LOAD:"onDataLoad",SAVE:"onDataSave"});OJ.extendClass("NwDataView",[OjView],{_p_:{data:null},_is_api_data:false,_c:function(){this._s(OjView,"_c",arguments);this._load_checkpoints.data=false;this._props={}},_listeners:function(a){switch(a){case"data":return[this._data,NwDataEvent.LOAD,NwDataEvent.FAIL]}return this._s(OjView,"_listeners",arguments)},load:function(){this._s(OjView,"load",arguments);if(this._data){if(this._is_api_data&&!this._data.isLoaded()){this._updateListeners("add","data");this._data.load()}else{this._onDataSuccess(null)}}},_onDataFail:function(a){this._updateListeners("remove","data");this._loadCheckpoint("data")},_onDataSuccess:function(a){this._updateListeners("remove","data");this._loadCheckpoint("data");var b;for(b in this._props){this._props[b].value=this._data.property(b)}},"=data":function(c){if(this._data==c){return}this._data=c;this._is_api_data=this._data&&this._data.is(NwIApiData);this._props={};this.removeAllElms();var b=this._data.oj_class.sortedDefinition(),a,d;for(a in b){d=b[a];if(d.userCanRead(AppManager.user,this._data)){this.addElm(this._props[a]=d.makeDisplay())}}}});OJ.extendClass("NwProperty",[OjObject],{_p_:{allowDuplicate:true,placeholder:null,defaultValue:null,flatten:false,itemRenderer:OjLabelItemRenderer,label:null,max:1,min:0,notes:null,readCallback:null,readPermission:"*",required:false,unique:false,weight:0,writeCallback:null,writePermission:"*"},_g_p_:{name:null,type:"TEXT"},_c:function(b){this._s(OjObject,"_c",[]);if(b){for(var a in b){this[a]=b[a]}}},_exportValue:function(b,a,c){return b},_formatter:function(e,f){var d=arguments.length,a=d>2?arguments[2]:null,h=d>3?arguments[3]:NwData.DEFAULT;if(this._max!=1){var g=isArray(a)?a.length:0;if(!f){return[]}if(!isArray(f)){return[e.call(this,f,g?a[0]:null,h)]}var c=[];for(var b=f.length;b--;){c.unshift(e.call(this,f[b],b<g?a[b]:null,h))}return c}return e.call(this,f,a,h)},_getValue:function(d,a){var c=this.name;if(!a){throw'Property "'+c+'" get not allowed.'}var b=d[a];if(b){return b.call(d)}return d._property(c)},_importValue:function(b,a,c){return b},_setValue:function(d,e,c){var b=this.name;if(!e){throw'Property "'+b+'" set not allowed.'}var a=d[e];if(a){a.call(d,c)}else{d._property(b,c)}return c},_valueIsValid:function(a){return true},exportValue:function(a,b){return this._formatter(this._exportValue,a,null,b)},importValue:function(b,a,c){return this._formatter(this._importValue,b,a,c)},isMultiSelection:function(){return this._max!=1},isOptionalSelection:function(){return this._min==0&&!this._required},isSingleSelection:function(){return this._max==1},makeDisplay:function(){var a=this,b=new OjValue(a.name,a.label,a.defaultValue);b.itemRenderer=a.itemRenderer;return b},makeInput:function(){var b=this,a;if(arguments.length&&isObjective(a=arguments[0])){}else{a=new OjTextInput(b.name,b.label,b.defaultValue)}a.placeholder=b.placeholder;a.required=b.required;a.notes=b.notes;return a},setup:function(c,b){this.name=b;var e=this,a="."+b,d="="+b;Object.defineProperty(c,b,{configurable:true,enumerable:false,get:function(){return e._getValue(this,a)},set:function(f){return e._setValue(this,d,f)}})},userCanRead:function(a,b){return this._readPermission&&a.hasPermission(this._readPermission)&&(!this._readCallback||this._readCallback(a,b,this))},userCanWrite:function(a,b){return this._writePermission&&a.hasPermission(this._writePermission)&&(!this._writeCallback||this._writeCallback(a,b,this))},valueIsValid:function(c){if(this._max==1){return this._valueIsValid(c)&&(!this._min||isSet(c))}if(!isArray(c)){return false}var b=0;for(var a=c.length;a--;){if(!this._valueIsValid(c[a])){return false}b++}return !this._min||!(b<this._min)},".defaultValue":function(){return OJ.copy(this._defaultValue)},"=max":function(a){this._max=Math.max(a,0)},"=min":function(a){this._min=Math.max(a,0)}},{BLOB:"BLOB",DATE:"DATE",INTEGER:"INTEGER",NUMERIC:"NUMERIC",TEXT:"TEXT"});OjStyleElement.registerComponentTag("datainput",function(b){var a=b.getAttribute("source").split(".");b.removeAttribute("source");return OJ.stringToClass(a[0]).DEFINITION[a[1]].makeInput(b)});OjStyleElement.registerComponentTag("datainputs",function(e){var d=e.getAttribute("source"),a=OjStyleElement(),c=OJ.stringToClass(d).DEFINITION,b;e.removeAttribute("source");for(b in c){a.addChild(c[b].makeInput())}return a});OJ.extendClass("NwTextProperty",[NwProperty],{_p_:{minLength:0,maxLength:255},_processValue:function(a){if(a){a=String(a);if(this._maxLength&&a.length>this._maxLength){a=a.substr(0,this._maxLength)}if(this._minLength&&a.length<this._minLength){a=null}}return a},_valueIsValid:function(a){if(!this._minLength&&isNull(a)){return true}a=String(a);return(!this._minLength||a.length>=this._minLength)&&(!this._maxLength||a.length<=this._maxLength)},makeInput:function(){var b=this,c=arguments;if(!c.length&&b.maxLength>255){c[0]=new OjTextArea(b.name,b.label,b.defaultValue);c.length=1}var a=this._s(NwProperty,"makeInput",c);a.minLength=b.minLength;a.maxLength=b.maxLength;return a},"=maxLength":function(a){this._maxLength=Math.max(a,0)},"=minLength":function(a){this._minLength=Math.max(a,0)}});OJ.extendComponent("NwDataListEditor",[OjItemEditor],{_t:"<div><div var=item></div><div var=actions v-align=m><a var=view_btn on-press=_onViewPress>View</a><a var=edit_btn on-press=_onEditPress>Edit</a><a var=delete_btn on-press=_onDeletePress>Delete</a></div></div>",_onDataChange:function(a){if(this._item){this._item.redraw()}},_onViewPress:function(b){var a=this._group.controller;if(a){a.addView(this._data.makeView())}},_onEditPress:function(b){var a=this._group.controller;if(a){a.addView(this._data.makeForm())}},"=data":function(a){if(this._data==a){return}if(this._data){this._data.removeEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}this._s(OjItemEditor,"=data",arguments);if(this._data){this._data.addEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}},".itemRenderer":function(){return this._data?this._data.oj_class.ITEM_RENDERER:this._itemRenderer}});OJ.extendClass("NwDataErrorEvent",[OjErrorEvent],{_g_p_:{data:null},_c:function(b){var a=Array.array(arguments),c=a.length;if(c>1){this._data=a[1];a.removeAt(1)}this._s(OjErrorEvent,"_c",a)}},{DELETE:"onDataDeleteError",LOAD:"onDataLoadError",SAVE:"onDataSaveError"});OJ.extendClass("NwDataForm",[OjForm],{_p_:{autoUpdate:false,data:null},_submitting:false,_is_api_data:false,_c:function(){this._s(OjForm,"_c",arguments);this._load_checkpoints.data=false},_listeners:function(a){switch(a){case"dataLoad":return[this._data,NwDataEvent.LOAD,NwDataErrorEvent.LOAD];case"dataSave":return[this._data,NwDataEvent.SAVE,NwDataErrorEvent.SAVE]}return this._s(OjForm,"_listeners",arguments)},_showInput:function(a){return a.userCanWrite(AppManager.user,this._data)},load:function(){if(this._s(OjForm,"load",arguments)){if(this._data){if(this._is_api_data&&!this._data.isLoaded()){this._updateListeners("add","dataLoad");this._data.load()}else{this._onDataLoadSuccess(null)}}return true}return false},submit:function(){if(this._submitting){return false}if(this._s(OjForm,"submit",arguments)){this._showOverlay();this._data.importData(this._dirty);this._updateListeners("add","dataSave");this._submitting=true;this._data.save();return true}return false},_onDataLoadSuccess:function(a){this._updateListeners("remove","dataLoad");this._loadCheckpoint("data");var b;for(b in this._props){this._props[b].value=this._data.property(b);this._props[b].addEventListener(OjEvent.CHANGE,this,"_onInputChange")}},_onDataLoadFail:function(a){this._updateListeners("remove","dataLoad");this._loadCheckpoint("data")},_onDataSave:function(a){this._submitting=false;this._hideOverlay();this._updateListeners("remove","dataSave");if(a){this.dispatchEvent(a)}},_onDataSaveSuccess:function(a){if(this._controller){this._controller.removeView(this)}this._onDataSave(a)},_onDataSaveFail:function(a){this._onDataSave(a)},_onInputChange:function(a){var b=a.currentTarget,c=b.name,d=b.value,e=this._data.oj_class.getProperty(c);if(isArray(d)&&!e.isMultiSelection()){d=d[0]}else{if(d==""){d=null}}if(this._data.isNew()||this._autoUpdate){this._data.property(c,d)}else{this._dirty[c]=d}},_onSubmitClick:function(a){this.submit()},".data":function(){return this._data},"=data":function(e){var a=this,c=a._data,b,d,f;if(c==e){return}if(c){a.removeCss(c.oj_class_name.toLowerCase()+"-form");a.removeAllElms();if(a._props){for(b in a._props){OJ.destroy(a._props[b])}}}if(a._data=e){if(!e.is(NwData)){throw"NwDataForm requires that data be an instance of NwData."}a.addCss(e.oj_class_name.toLowerCase()+"-form");a._is_api_data=e.is(NwIApiData);a._props={};a._dirty={};d=e.oj_class.sortedDefinition();for(b in d){f=d[b];if(a._showInput(f,e)){a.appendElm(a._props[b]=f.makeInput())}}}}},{_TAGS:["dataform"]});OJ.extendClass("NwDataListItem",[OjListItem],{_d:function(){if(this._data&&this._data.is&&this._data.is("NwData")){this._data.removeEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}return this._s(OjListItem,"_d",arguments)},_redrawData:function(){if(this._s(OjListItem,"_redrawData",arguments)){var a,b;if(this._data){a=this._data.title();b=this._data.icon()}this.content.text=a;this.icon.source=b;return true}return false},"=data":function(a){if(this._data&&this._data.is&&this._data.is("NwData")){this._data.removeEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}this._s(OjListItem,"=data",arguments);if(this._data&&this._data.is&&this._data.is("NwData")){this._data.addEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}}});OJ.extendClass("NwData",[OjActionable],{_post_compile_:function(b,d){NwData.registerDataType(b.TYPE,d._class_name);var e=b.DEFINITION,f=b.EXPORT_MAP,a=(b.IMPORT_MAP=Object.clone(b.IMPORT_MAP)),c;for(c in e){e[c].setup(d,c)}for(c in f){a[f[c]]=c}b._BACKLOG=[];b._CACHE={}},_c:function(){this._s(OjActionable,"_c",[]);this._data={};var c=this.$.DEFINITION,a;for(a in c){this._data[a]=c[a].defaultValue}this._dirty={};this._keyword_cache={};var b=arguments.length;if(b){this._prevent_dispatch=true;this.importData(arguments[0],b>1?arguments[1]:NwData.DEFAULT);this._prevent_dispatch=false}},_addToDirty:function(b,a){if(!this._dirty[b]){var a=this._data[b];if(isArray(a)||(isObjective(a)&&a.is(OjArray))){a=a.clone()}this._dirty[b]=a}else{if(a==this._dirty[b]){delete this._dirty[b]}}},_exportProp:function(b,a){return true},_exportValue:function(c,b,a){a=isUndefined(a)?this._data[c]:a;if(this.$.hasProperty(c)){return this.$.DEFINITION[c].exportValue(a,b)}return a},_getProp:function(d,e,a){if(!a){throw'Property "'+d+'" get not allowed.'}var b=this,c=b[a];if(c){return c.call(b)}return b[e]},_importValue:function(g,e,f){var b=this,a=b.$;if(a.hasProperty(g)){e=a.DEFINITION[g].importValue(e,b[g],f);this._property(g,e);return}var c=g.indexOf(".");if(c>0){var d={};d[g.substr(c+1)]=e;this._importValue(g.substr(0,c),d,f)}},_property:function(h,g){var c=this,d=arguments,e=c._data[h];if(d.length>1){var b=c.$,f=b.DEFINITION,a=NwDataEvent;if(!f||!f[h]){throw new Error()}if(e!=(g=f[h].importValue(g,e,NwData.DEFAULT))){if(h==b.KEY){c._updateCache(e,g)}c._addToDirty(h,g);c._data[h]=g;if(f[h].is(NwTextProperty)){c._keyword_cache[h]=g?g.toString().toLowerCase():null}c.dispatchEvent(new a(a.CHANGE,g,e))}}return e},_setProp:function(c,f,e,d){if(!e){throw'Property "'+c+'" set not allowed.'}var b=this,a=b[e];if(a){a.call(b,d)}else{b[f]=d}return d},_updateCache:function(a,b){a=this.$.key(a);b=this.$.key(b);if(a){delete this.$._CACHE[a]}if(b){this.$._CACHE[b]=this}},_onLoad:function(a){this.dispatchEvent(new NwDataEvent(NwDataEvent.LOAD));this.$.dispatchEvent(new NwDataEvent(NwDataEvent.LOAD,this))},_onSave:function(a){this.dispatchEvent(new NwDataEvent(NwDataEvent.SAVE,this));this.$.dispatchEvent(new NwDataEvent(NwDataEvent.SAVE,this))},clone:function(){var a=this._s(OjActionable,"clone",[]);a.importData(this._data,NwData.CLONE);return a},del:function(){},exportData:function(f){f=f?f:NwData.DEFAULT;var h,e,d,b,c,i=this.$,g=f==NwData.DEFAULT,a=i.EXPORT_MAP;if(g){d=this._s(OjActionable,"exportData",arguments)}else{d={};if(!this.isNew()){d[i.KEY]=this.key()}}for(h in this._data){if(g||this._exportProp(h,f)){c=this._exportValue(h,f);if(isObject(c)&&(b=i.getProperty(h)).flatten){for(h in c){if(h==i.DATA_KEY){continue}e=b.namespace+"."+h;d[a[e]?a[e]:e]=c[h]}}else{d[a[h]?a[h]:h]=c}}}return d},icon:function(){return null},importData:function(b){var e,d=arguments.length>1?arguments[1]:NwData.DEFAULT,c=this.$.IMPORT_MAP,a=this.$.KEY;for(e in b){if(d==NwData.CLONE&&e==a){continue}this._importValue(c[e]?c[e]:e,b[e],d)}},isDirty:function(){if(arguments.length&&arguments[0]==false){this._dirty={}}return !isEmptyObject(this._dirty)},isNew:function(){return isEmpty(this.key())},key:function(c){var a=this,b=a.$.KEY;if(isSet(c)){a[b]=c}return a[b]},load:function(){this._onLoad(null)},keywordScore:function(a){var c=[],e=0;if(isArray(a)){c=a}else{c.append(a)}var b,d=c.length;while(d-->0){for(b in this._keyword_cache){if(this._keyword_cache[b]){e+=this._keyword_cache[b].count(c[d].toLowerCase())/(d+1)}}}return e},makeForm:function(){var a=new this.$.FORM_RENDERER();a.data=this;if(this.isNew()){a.title="Create "+this.$.title;a.submitLabel="Create"}else{a.title="Edit: "+this.title;a.submitLabel="Save"}return a},makeView:function(){var a=new this.$.VIEW_RENDERER();a.title="View: "+this.title;a.data=this;return a},reset:function(){var a;for(a in this._dirty){this._data[a]=this._dirty[a]}this._dirty={}},save:function(){this._onSave(null)},title:function(){return null}},{CLONE:"clone",DEFAULT:"default",DEFINITION:{id:new NwTextProperty()},KEY:"id",ORDER_KEY:null,DATA_KEY:"_class_name",TYPE:"Data",EXPORT_MAP:{},IMPORT_MAP:{},FORM_RENDERER:NwDataForm,ITEM_EDITOR:NwDataListEditor,ITEM_RENDERER:NwDataListItem,VIEW_RENDERER:NwDataView,_CACHE:{},_TYPES:{},addEventListener:function(b,a,c){EventManager.addEventListener(this,b,a,c)},all:function(){return this._CACHE},dispatchEvent:function(a){if(this._prevent_dispatch){return}EventManager.dispatchEvent(this,a)},get:function(e,b){var d=this,a;e=this.key(e);if(!this._CACHE[e]&&b){a=new d();a.key(e)}return this._CACHE[e]},getProperty:function(a){return this.DEFINITION[a]},has:function(a){return isSet(this._CACHE[this.key(a)])},hasEventListener:function(a){return EventManager.hasEventListener(this,a)},hasProperty:function(a){return !isUndefined(this.DEFINITION[a])},id:function(){if(!this.CLASS_NAME){this.CLASS_NAME=OJ.classToString(this)}return this.CLASS_NAME},importData:function(b,e){var a;if(!e){e=NwData.DEFAULT}if(isArray(b)){a=b.length;for(;a--;){b[a]=this.importData(b[a],e)}return b}if(isObject(b)){var g=b[NwData.DATA_KEY]?this.typeToClass(b[NwData.DATA_KEY]):this;if(g){var d,f=this.key(b[g.KEY]);if(f&&g._CACHE[f]){d=g._CACHE[f]}else{d=new g()}d.importData(b,e);return d}}return null},key:function(a){return a},registerDataType:function(a,b){NwData._TYPES[a]=b},removeAllListeners:function(){return EventManager.removeAllListeners(this)},removeEventListener:function(b,a,c){EventManager.removeEventListener(this,b,a,c)},sortedDefinition:function(){if(!this.SORTED_DEFINITION){this.SORTED_DEFINITION={};var c,d=0,a=[];for(c in this.DEFINITION){a.append([c,this.DEFINITION[c].weight]);d++}a.sort(function(f,e){return f[1]-e[1]});for(var b=0;b<d;b++){c=a[b][0];this.SORTED_DEFINITION[c]=this.DEFINITION[c]}}return this.SORTED_DEFINITION},title:function(){return this.TYPE},typeToClass:function(a){if(NwData._TYPES[a]){a=NwData._TYPES[a]}return OJ.stringToClass(a)}});OJ.defineClass("NwIPersistentData",{_is_loaded:false,del:function(){},isLoaded:function(){return this._is_loaded||this.isNew()},load:function(){},save:function(){}},{get:function(){},search:function(){}});OJ.extendClass("NwDateProperty",[NwProperty],{_type:NwProperty.DATE,_importValue:function(a){if(a&&!isDate(a)){if(isObject(a)&&a.__type__=="date"){a=a.data}a=new Date(a)}if(this._max_date&&a>this._max_date){a=new Date(this._max_date.getTime())}if(this._min_date&&a<this._min_date){a=new Date(this._min_date.getTime())}return a},_valueIsValid:function(a){return isDate(a)&&(!this._min_date||a>=this._min_date)&&(!this._max_date||a>=this._max_date)},".maxLength":function(){return this._max_date},"=maxLength":function(a){this._max_date=!this._min_date||a>this._min_date?a:this._min_date},".minDate":function(){return this._min_date},"=minDate":function(a){this._min_date=!this._max_date||a<this._max_date?a:this._max_date}});OJ.extendClass("NwNumberProperty",[NwProperty],{_p_:{maxValue:null,minValue:null,rouding:"round",step:0},_type:NwProperty.NUMERIC,_importValue:function(a){if(!isNumber(a)){a=parseFloat(a)}if(isSet(this._minValue)){a=Math.max(this._minValue,a)}if(isSet(this._maxValue)){a=Math.min(this._maxValue,a)}if(this._step){}if(this._type==NwProperty.INTEGER){a=this._round(a)}return a},_round:function(a){if(this._rounding==NwNumberProperty.CEIL){return Math.ceil(a)}if(this._rounding==NwNumberProperty.FLOOR){return Math.floor(a)}return Math.round(a)},_valueIsValid:function(a){if(!isNumber(a)||(this._type==NwProperty.INTEGER&&!isInt(a))||(isSet(this._minValue)&&a<this._minValue)||(isSet(this._maxValue)&&a>this._maxValue)){return false}return true},"=type":function(){throw new Error("Cannot set NwNumberProperty type.")}},{CEIL:"ceil",FLOOR:"floor",ROUND:"round"});OJ.extendClass("NwIntegerProperty",[NwNumberProperty],{_type:NwProperty.INTEGER,"=type":function(){throw new Error("Cannot set number type on NwIntProperty.")}});OJ.defineClass("NwIUser",{hasPermission:function(c){if(c=="*"||this.isAdmin()){return true}var b=this.roles;if(b){for(var a=b.length;a;a--){if(AppManager.roleHasPermission(b[a],c)){return true}}}return false},isAdmin:function(){return AppManager.userIsAdmin(this)}});OJ.extendClass("NwUser",[NwData,NwIUser],{},{DEFINITION:{id:new NwIntegerProperty(),name:new NwTextProperty(),roles:new NwTextProperty({max:0})},TYPE:"User",ADMIN:"admin"});OJ.extendClass("NwSession",[OjActionable],{_p_:{data:null,token:null,user:null},_g_p_:{isLoggedIn:null},_c:function(){this._s(OjActionable,"_c",[]);this._data={};var a=arguments.length;if(a){this.token=arguments[0];if(a>1){this.data=arguments[1]}}},exportData:function(){var b=this,d=b._s(OjActionable,"exportData",arguments),c=b.data,a=b.user;d.data=c?OjObject.exportData(c):{};d.token=b._token;d.user=a?a.exportData():null;return d},importData:function(b){var a=this;a.data=b&&b.data?OjObject.importData(b.data):{};a.token=b&&b.token?b.token:null;a.user=b&&b.user?a.$.USER_CLASS.importData(b.user):null;this.save()},".isLoggedIn":function(){return !isEmpty(this._token)&&!isEmpty(this._user)&&this._user.key()},save:function(){this.dispatchEvent(new OjEvent(OjEvent.CHANGE))},get:function(a){return this._data[a]},set:function(a,b){if(this._data[a]==b){return}this._data[a]=b;this.save()},unset:function(a){delete this._data[a];this.save()},"=data":function(a){if(this._data==a){return}this._data=a?a:{};this.save()},"=token":function(a){if(this._token==a){return}this._token=a;this.save()},newUser:function(a){this.$.newUser(a)},"=user":function(a){if(this._user==a){return}this._user=a;this.save()}},{USER_CLASS:NwUser,newUser:function(b){var a=this.USER_CLASS;return b?a.importData(b):new a()}});OJ.extendClass("NwActionCard",[OjAlert],{_p_:{actions:null,allowMultiple:false},_t:"<div><div var=underlay></div><div var=pane><div var=actions><label var=title></label><button var=destroyBtn on-press=_onDestroyPress>Delete</button></div><button var=cancelBtn on-press=_onCancelPress>Cancel</button></div></div>",_c:function(){this._s(OjAlert,"_c",[]);this._processArguments(arguments,{actions:[],title:null,cancelLabel:"Cancel",destroyLabel:null})},_d:function(){var a=arguments,b=a.length?a[0]:0;this._u(["title","actions","cancelBtn"]);return this._s(OjModal,"_d",arguments)},_onActionItemPress:function(a){if(!this._allowMultiple){this.dispatchEvent(new OjAlertEvent(OjAlertEvent.BUTTON_PRESS,a.index));WindowManager.hide(this)}},_onDestroyPress:function(a){},"=actions":function(b){var a=this._actions;if(a==b){return}if(a){a.parent=null;a.removeEventListener(OjCollectionEvent.ITEM_PRESS,this,"_onActionItemPress")}this.actions.insertChild(a=this._actions=b,this.actions.numChildren()-1);if(a){a.addEventListener(OjCollectionEvent.ITEM_PRESS,this,"_onActionItemPress")}},".cancelLabel":function(){return this.cancelBtn.label},"=cancelLabel":function(a){this.cancelBtn.label=a;if(isEmpty(a)){this.cancelBtn.hide()}else{this.cancelBtn.show()}},".cancelIcon":function(){return this.cancelBtn.icon},"=cancelIcon":function(a){this.cancelBtn.icon=a},".destroyLabel":function(){return this.destroyBtn.label},"=destroyLabel":function(a){this.destroyBtn.label=a;if(isEmpty(a)){this.destroyBtn.hide()}else{this.destroyBtn.show()}},".title":function(){return this.title.text},"=title":function(a){if(isEmpty(a)){this.title.hide()}else{this.title.label=a;this.title.show()}}});OJ.extendComponent("NwActionButton",[OjItemRenderer],{_t:"<div><button var=btn></button></div>",_redrawData:function(){if(this._s(OjItemRenderer,"_redrawData",arguments)){this.btn.text=this._data;return true}return false}});OJ.extendManager("WindowManager","NwWindowManager",[OjWindowManager,NwManager],{_p_:{actionCardClass:NwActionCard},_namespace:"nwUi",_actionCard:function(b){var a=arguments;a[0]=new OjList(b,NwActionButton);return this.makeActionCard.apply(this,a)},_isMobileAC:function(a){return a.is(NwActionCard)&&OJ.is_mobile},_transIn:function(c){this._s(OjWindowManager,"_transIn",arguments);if(this._isMobileAC(c)){var b=c.pane.height,d=c.pane.y;c.pane.y=d+b;var a=new OjMove(c.pane,OjMove.Y,d,250,OjEasing.OUT);a.start()}},_transOut:function(c){this._s(OjWindowManager,"_transOut",arguments);if(this._isMobileAC(c)){var b=c.pane.height,d=c.pane.y;var a=new OjMove(c.pane,OjMove.Y,d+b,250,OjEasing.OUT);a.start()}},alert:function(c,d,b,a){if(NW.isNative){this._comm("alert",arguments)}else{return this._s(OjWindowManager,"alert",arguments)}},actionCard:function(d,c){var b=Array.slice(arguments,1),a=this._actionCard.apply(this,b);if(NW.isNative){this._comm("actions",[a.title,a.cancelLabel,a.destroyLabel,c,d.pageRect])}else{this.show(a)}return a},browser:function(a,b){if(NW.isNative){return this._comm("browser",Array.array(arguments))}return this._s(OjWindowManager,"browser",arguments)},call:function(a){if(NW.isNative){return this._comm("call",Array.array(arguments))}return this._s(OjWindowManager,"call",arguments)},email:function(a){if(NW.isNative){return this._comm("email",[a])}return this._s(OjWindowManager,"email",arguments)},makeActionCard:function(){return this._actionCardClass.makeNew(arguments)},position:function(e){if(this._isMobileAC(e)){var b=e.width,d=e.height,a=e.paneWidth,c=e.paneHeight;e.pane.x=(b-a)/2;e.pane.y=d-c;return}this._s(OjWindowManager,"position",arguments)},txt:function(a,b){if(NW.isNative){return this._comm("txt",Array.array(arguments))}return this._s(OjWindowManager,"txt",arguments)}});OJ.extendClass("NwUrlLoader",[OjUrlLoader],{_async:true});OJ.extendClass("NwUrlRequest",[OjUrlRequest],{_p_:{priority:0,method:OjUrlRequest.POST,weight:0},_c:function(){this._s(OjUrlRequest,"_c",arguments);this.contentType=OjUrlRequest.JSON}});OJ.extendManager("CacheManager","NwCacheManager",[OjCacheManager],{_is_native:false,_c:function(a){this._s(OjCacheManager,"_c",arguments);if(this._is_native=NW.isNative){}this._policies=a._policies;this._cache_size=a._cache_size},getNativeData:function(a){},setNativeData:function(a,b){},unsetNativeData:function(a){}});OJ.defineClass("NwIApp",{_g_p_:{db:null,isLoggedIn:null,maxWidth:null,maxHeight:null,minWidth:320,minHeight:320,systemBar:"appSystemBarDefault",url:null},_p_:{session:null},_ready:false,_scale:1,_api_endpoint:"",_api_request_type:OjUrlRequest.QUERY_STRING,_has_mobile_layout:false,_has_tablet_layout:false,_session_class:NwSession,_init:function(){var a=HistoryManager.get();this._url=a.protocol+"://"+a.host;if((OJ.is_mobile&&this._has_mobile_layout)||(OJ.is_tablet&&this._has_tablet_layout)){this._scale=OJ.pixel_ratio;OJ.meta("viewport","width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no");OJ.meta("apple-mobile-web-app-capable","yes")}if(this._orientations){NW.supportedOrientations=this._orientations}if(this._minWidth&&this._minHeight){NW.minSize=[this._minWidth,this._minHeight]}if(this._maxWidth&&this._maxHeight){NW.maxSize=[this._maxWidth,this._maxHeight]}AppManager.init(this)},_buildApiUrl:function(b){var a=String.string(b);if(!a){a="/"}else{if(a.charAt(0)!="/"){a="/"+a}}return this._api_endpoint+a},_login:function(a){if(a){this.dispatchEvent(new OjEvent(NwApp.LOGIN_FAIL));AppManager.dispatchEvent(new OjEvent(NwApp.LOGIN_FAIL))}else{this.dispatchEvent(new OjEvent(NwApp.LOGIN));AppManager.dispatchEvent(new OjEvent(NwApp.LOGIN))}},_logout:function(a){if(a){this.dispatchEvent(new OjEvent(NwApp.LOGOUT_FAIL));AppManager.dispatchEvent(new OjEvent(NwApp.LOGOUT_FAIL))}else{this.dispatchEvent(new OjEvent(NwApp.LOGOUT));AppManager.dispatchEvent(new OjEvent(NwApp.LOGOUT))}},_onSaveSession:function(a){CacheManager.setData(this.oj_class_name,this._session)},_onSessionChange:function(a){this._timer.restart();try{var c=this._session.user.roles,f=this.cssList,d=f.length,b;for(;d--;){b=f[d];if(b.indexOf("user-role-")==0){f.removeAt(d)}}d=c.length;for(;d--;){f.append("user-role-"+c[d])}this.css=f}catch(g){}},apiRequest:function(d,c,e,b){var a=new NwUrlLoader(new NwUrlRequest(this._buildApiUrl(d),c,this._api_request_type,isUndefined(e)?OjUrlRequest.GET:e),isUnset(b)?true:b);a.contentType=this._api_response_type;return a},init:function(){this._acl={};this._timer=new OjTimer(100,1);this._timer.addEventListener(OjTimer.COMPLETE,this,"_onSaveSession");if(!(this.session=CacheManager.getData(this.oj_class_name))){this.session=this.newSession()}this.redraw()},login:function(){},logout:function(){},newSession:function(b){var a=this._session_class,c=new a();if(b){c.importData(b)}if(!c.user){c.user=a.newUser()}return c},newUser:function(a){return this._session_class.newUser(a)},".isLoggedIn":function(){var a=this.session;return a&&a.isLoggedIn},"=session":function(a){if(this._session!=a){if(this._session){this._session.removeEventListener(OjEvent.CHANGE,this,"_onSessionChange")}if(this._session=a){a.addEventListener(OjEvent.CHANGE,this,"_onSessionChange");this._onSessionChange(null)}}return a},"=systemBar":function(b){this._systemBar=b;if(NwApp.OS==NwApp.IOS){var a;switch(this._systemBar){case NwApp.SYSTEM_BAR_BLACK:a="black";break;case NwApp.SYSTEM_BAR_BLACK_NONE:case NwApp.SYSTEM_BAR_BLACK_TRANS:a="black-translucent";break;case NwApp.SYSTEM_BAR_LIGHT:a="light";break;default:a="default";break}OJ.meta("apple-mobile-web-app-status-bar-style",a)}}});OJ.extendClass("NwApp",[OjView,NwIApp],{_c:function(){this._init();this._s(OjView,"_c",arguments)}},{LOGIN:"onLogin",LOGIN_FAIL:"onLoginFail",LOGOUT:"onLogout",LOGOUT_FAIL:"onLogoutFail",SYSTEM_BAR_BLACK:"appSystemBarBlack",SYSTEM_BAR_BLACK_TRANS:"appSystemBarBlackTranslucent",SYSTEM_BAR_DEFAULT:"appSystemBarDefault",SYSTEM_BAR_LIGHT:"appSystemLight",SYSTEM_BAR_NONE:"appSystemBarNone"});OJ.extendClass("NwAppMessage",[OjAlert],{_p_:{icon:null},_c:function(){var a=this;a._s(OjAlert,"_c",arguments);a.addEventListener(OjUiEvent.PRESS,a,"_onPress")},_onPress:function(a){this.cancel()},"=icon":function(c){var a=this,b=a.icn;if(a._icon==c){return}if(a._icon=c){if(!b){a.icn=b=new OjImage();b.addCss("fa-stack","fa-3x","icn");b.prependChild(new OjStyleElement('<i class="fa fa-heart fa-stack-2x"></i>'));a.pane.prependChild(b)}b.source=c}else{a.unset("icn")}}});OJ.extendManager("AppManager","NwAppManager",[OjActionable],{_p_:{session:null,user:null},_g_p_:{app:null,isLoggedIn:null,ready:false},_oj_ready:false,_loadings:[],_c:function(){this._s(OjActionable,"_c",[]);if(OJ.is_ready){this._onOjReady(null)}else{OJ.addEventListener(OjEvent.READY,this,"_onOjReady")}},_initApp:function(){var b=this,c=b.app,a=OjEvent;if(b._oj_ready&&c&&OJ.is_supported&&!b._ready){b._ready=true;c.init();b.dispatchEvent(new a(a.INIT))}},_onOjReady:function(a){var b=this;if(!b._oj_ready){b._oj_ready=true;OJ.removeEventListener(OjEvent.READY,b,"_onOjReady");b._initApp()}},init:function(){if(arguments.length){this._app=arguments[0];this._initApp()}return this},_num_loading:0,_makeAlert:function(c,d,b){var a=new NwAppMessage(c,d);a.paneWidth=300;a.paneHeight=300;if(b){a.icon="@fa fa-inverse fa-stack-1x fa-"+b}return a},_showMessage:function(d,f,c,e){var a=this,b=a._message,g=a._alert_timer;if(b){b.cancel();if(g){g.cancel()}}a._alert=b=a._makeAlert(d,f,c);b.present();e=isUnset(e)?1000:e;if(e){a._alert_timer=g=new OjTimer(e);g.addEventListener(OjTimer.COMPLETE,a,"_onAlertTimerDone");g.start()}return b},hideAllLoading:function(){},hideAllMessages:function(){},hideLoading:function(){var a=this,b=a._loading;if(--a._num_loading>0||!b){return}b.cancel();a._num_loading=0;a._loading=null},hideMessage:function(){},showError:function(b,d,a,c){return this.showMessage(b,d||"Error",a||"exclamation",c)},showLoading:function(c,a){var b=this,d=b._loading;b._num_loading++;if(d){d.title=c}else{b._loading=d=b._makeAlert(null,c||"Loading","circle-o-notch fa-spin");d.present()}return b._loading},showMessage:function(b,d,a,c){return this._showAlert(b,d,a,c)},showSuccess:function(b,d,a,c){return this.showMessage(b,d||"Success",a||"smile-o",c)},apiRequest:function(){var a=this.app;if(!a){throw new Error("No application initialized.")}return a.apiRequest.apply(a,arguments)},login:function(){var a=this.app;return a.login.apply(a,arguments)},logout:function(){var a=this.app;return a.logout.apply(a,arguments)},newSession:function(a){return this.app.newSession(a)},newUser:function(a){return this.app.newUser(a)},userIsAdmin:function(){var b=arguments.length?arguments[0]:this.user,c=b?b.roles:null,a=b.oj_class.ADMIN;return c&&c.contains(a)},".isLoggedIn":function(){return this.app.isLoggedIn},".db":function(){return this.app.db},".session":function(){return this.app.session},"=session":function(a){this.app.session=a},".user":function(){var a=this.session;return a?a.user:null},"=user":function(b){var a=this.session;if(a){a.user=b}}});OjStyleElement.registerComponentTag("app",function(c){var a=window[c.getAttribute("class-name")];var b=new a();AppManager.init(b);return b});OJ.extendClass("NwEvent",[OjEvent],{_g_p_:{data:null},_c:function(a){var b=arguments.length;this._s(OjEvent,"_c",b>3?[].slice.call(arguments,0,3):arguments);if(b>3){this._data=arguments[3]}}});OJ.extendClass("NwRpc",[OjRpc],{_g_p_:{gateway:null},_c:function(a,c,b){this._s(OjRpc,"_c",arguments);this._request.data.gateway=NW.gateway}});OJ.extendClass("NwAnalyticsData",[OjObject],{_p_:{date:null},_c:function(){this._s(OjObject,"_c",[]);this.date=new Date()}});OJ.extendClass("NwAnalyticsAction",[NwAnalyticsData],{_p_:{category:null,isBounce:null,params:null,name:null},_c:function(a){this._s(NwAnalyticsData,"_c",[]);this.name=a;this._processArguments(arguments,{category:undefined,params:undefined,isBounce:false})}});OJ.extendClass("NwAnalyticsEvent",[OjEvent],{_g_p_:{data:null},_c:function(a,b){this._s(OjEvent,"_c",[a,false,true]);this._data=b}},{ACTION:"onAnalyticsAction",MESSAGE:"onAnalyticsMessage",VIEW:"onAnalyticsView"});OJ.extendClass("NwAnalyticsMessage",[NwAnalyticsData],{});OJ.extendClass("NwAnalyticsView",[NwAnalyticsData],{_p_:{title:null,path:null},_c:function(){this._s(NwAnalyticsData,"_c",[]);this._processArguments(arguments,{path:undefined,title:undefined})},"=path":function(a){if(this._path==a){return}if((this._path=a)&&a.charAt(0)!="/"){this._path="/"+a}}});OJ.extendManager("Analytics","NwAnalytics",[OjActionable],{_c:function(){this._s(OjActionable,"_c",[])},enableEngine:function(a){a.enable()},disableEngine:function(a){a.disable()},log:function(a){this.dispatchEvent(new NwAnalyticsEvent(NwAnalyticsEvent.MESSAGE,new NwAnalyticsMessage(a)))},trackEvent:function(d){var a=arguments,b=a.length,c=new NwAnalyticsAction(d);if(b>1){c.category=a[1];if(b>2){c.params=a[2];if(b>3){c.isBounce=a[3]}}}this.dispatchEvent(new NwAnalyticsEvent(NwAnalyticsEvent.ACTION,c))},trackView:function(){var a=arguments,b=a.length,c=new NwAnalyticsView();if(b){c.path=a[0];if(b>1){c.title=a[1]}}this.dispatchEvent(new NwAnalyticsEvent(NwAnalyticsEvent.VIEW,c))}});OJ.extendClass("NwAnalyticsEngine",[OjActionable],{_queue:null,_processing:false,_c:function(){this._s(OjActionable,"_c",[]);this._queue=new OjArray();if(!this.$._HAS_LIBRARY){this._loadLibrary()}this._init()},_init:function(){},_loadLibrary:function(){this.$._HAS_LIBRARY=true},_processActionItem:function(a){return false},_processItem:function(a){return false},_processQueue:function(){if(this._processing){return}this._processing=true;var c=this._queue.length,b,a;for(;c--;){a="_processItem";b=this._queue.getItemAt(c);switch(b.type){case NwAnalyticsEvent.ACTION:a="_processActionItem";break;case NwAnalyticsEvent.MESSAGE:a="_processMessageItem";break;case NwAnalyticsEvent.VIEW:a="_processViewItem";break}if(this[a](b)){this._queue.removeItemAt(c)}}this._processing=false},_processMessageItem:function(a){return false},_processViewItem:function(a){return false},_onAnalyticsEvent:function(a){this._queue.addItemAt(a,0);this._processQueue()},disable:function(){Analytics.removeEventListener(NwAnalyticsEvent.ACTION,this,"_onAnalyticsEvent");Analytics.removeEventListener(NwAnalyticsEvent.MESSAGE,this,"_onAnalyticsEvent");Analytics.removeEventListener(NwAnalyticsEvent.VIEW,this,"_onAnalyticsEvent")},enable:function(){Analytics.addEventListener(NwAnalyticsEvent.ACTION,this,"_onAnalyticsEvent");Analytics.addEventListener(NwAnalyticsEvent.MESSAGE,this,"_onAnalyticsEvent");Analytics.addEventListener(NwAnalyticsEvent.VIEW,this,"_onAnalyticsEvent")},log:function(){},track:function(a,b){this._onAnalyticsEvent(new NwAnalyticsEvent(NwAnalyticsEvent.TACK_EVENT,a,b))}},{_HAS_LIBRARY:false});OJ.extendClass("NwGoogleAnalytics",[NwAnalyticsEngine],{_g_p_:{key:null,namespace:null},_name:null,_c:function(a,b){this._key=a;this._namespace=b;this._s(NwAnalyticsEngine,"_c",arguments)},_call:function(){var a=arguments;if(this._name){a[0]=this._name+"."+a[0]}window.ga.apply(window.ga,a)},_init:function(){var a={},b=window.ga.getAll?window.ga.getAll():null;if(!isEmpty(b)){a.name=this._name=this.oj_id}window.ga("create",this._key,this._namespace,a)},_loadLibrary:function(){this._s(NwAnalyticsEngine,"_loadLibrary",[]);var a=window;a.GoogleAnalyticsObject="ga";a.ga=function(){(a.ga.q=a.ga.q||[]).append(arguments)};a.ga.l=1*new Date();OJ.loadJs("//www.google-analytics.com/analytics.js",true)},_processActionItem:function(a){var e=a.data,d=e.category,f=e.params,b={eventCategory:d?d:"misc",eventAction:e.name,nonInteraction:!e.isBounce};if(f){var c;for(c in f){b.eventLabel=c;b.eventValue=parseInt(f[c]);break}}this._send("event",b);return true},_processViewItem:function(a){var c=a.data,b={page:c.path,title:c.title};this._send("pageview",b);return true},_send:function(b,a){a.hitType=b;this._call("send",a)}});OJ.extendClass("NwFlowedApp",[NwApp],{nav:null,_routing:null,stack:null,_c:function(){this._s(NwApp,"_c",arguments);this.stack=new OjStack(OjStack.SLIDE_HORZ,250);this.stack.addCss("stack");this.addChild(this.stack);this.nav=new NwFlowNavController(this.stack);this.nav.id="nav";this.nav.addCss("nav");this.insertChild(this.nav,0);this._routing=new NwNavRoute("/","Home")},init:function(){var a=this._s(NwApp,"init",arguments);if(this.nav){this.nav.routing=this._routing}return a},load:function(a){if(isString(a)||(isObjective(a)&&a.is("OjUrl"))){this.nav.loadPath(a)}else{this.nav.loadRoute(a)}}});OJ.extendClass("NwTabbedApp",[NwApp],{_routing:null,_c:function(){this._s(NwApp,"_c",arguments);if(!this.stack){var a=new OjNavStack(OjStack.FADE,250);a.addCss(["stack"]);this.addChild(this.stack=a)}this.container=this.stack;if(!this.nav){var b=new OjTabNavController();b.addCss(["nav"]);this.addChild(this.nav=b)}this.nav.addEventListener(OjEvent.CHANGE,this,"_onViewChange")},_setupNavRouting:function(){},_onViewChange:function(a){},init:function(){var a=this._s(NwApp,"init",arguments);this.nav.stack=this.stack;return a},load:function(a){}});OJ.extendComponent("NwTray",[OjComponent],{_p_:{actuator:null,allowSlide:false,tray:null},_t:"<div><div var=tray></div><div var=container></div></div>",_is_open:false,_c:function(){this._s(OjComponent,"_c",[]);this._processArguments(arguments,{actuator:undefined,allowSlide:OJ.is_mobile&&NW.isNative})},_startTrayAnim:function(a,c){var d=OjEasing.STRONG_OUT,b=OjMove.X;this._stopTrayAnim();this._tray_anim=new OjTweenSet(new OjMove(this.tray,b,a,250,d),new OjMove(this.container,b,c,250,d));this._tray_anim.addEventListener(OjTweenEvent.COMPLETE,this,"_onAnimComplete");this._tray_anim.start()},_stopTrayAnim:function(){this._u("_tray_anim")},_updateActuatorListeners:function(a){if(this._actuator){this._actuator[a+"EventListener"](OjUiEvent.PRESS,this,"_onActuatorClick")}},_updateContainerListeners:function(a){this.container[a+"EventListener"](OjUiEvent.DOWN,this,"_onTrayBlur")},_updateDragListeners:function(a){if(this._actuator){this._actuator[a+"EventListener"](OjDragEvent.START,this,"_onActuatorDragStart");this._actuator[a+"EventListener"](OjDragEvent.MOVE,this,"_onActuatorDragMove")}},_onActuatorClick:function(a){this.toggleTray()},_onActuatorDragMove:function(a){},_onActuatorDragStart:function(a){},_onAnimComplete:function(a){this._stopTrayAnim();if(this._callback){this._callback();this._callback=null}},_onTrayBlur:function(a){this.hideTray()},hideTray:function(a){if(!this._is_open){if(a){a()}return}this._callback=a;this._startTrayAnim(this.width*-0.6,0);this._updateContainerListeners(OjActionable.REMOVE);this._is_open=false},showTray:function(b){if(this._is_open){if(b){b()}return}this._callback=b;var a=this.width*0.6;this.tray.width=a;this.tray.x=-1*a;this._startTrayAnim(0,a);this._is_open=true},toggleTray:function(){if(this._is_open){this.hideTray()}else{this.showTray()}},"=actuator":function(a){if(this._actuator==a){return}this._updateActuatorListeners(OjActionable.REMOVE);this._updateDragListeners(OjActionable.REMOVE);this._actuator=a;this._updateActuatorListeners(OjActionable.ADD);if(this._allowSlide){this._updateDragListeners(OjActionable.ADD)}},"=allowSlide":function(a){if(this._allowSlide==a){return}this._updateDragListeners((this._allowSlide=a)?OjActionable.ADD:OjActionable.REMOVE)},"=tray":function(a){this.tray.removeAllChildren();if(this._tray=a){this.tray.addChild(a)}},".trayPosition":function(){return this.container.x},"=trayPosition":function(b){var a=this.width*0.6;this.tray.x=Math.max(Math.min(b-a,0),-(a));this.container.x=Math.min(Math.max(b,0),a)}},{_TAGS:["tray"]});OJ.extendComponent("NwTrayApp",[NwTray,NwIApp],{_c:function(){this._s(NwTray,"_c",arguments);this._init()}});OJ.extendClass("NwBluetoothDeviceError",[OjEvent],{_g_p_:{data:null,device:null},_c:function(c,d,e,b,a){this._s(OjEvent,"_c",[c,b,a]);this._device=d;this._data=e}},{CONNECT:"onBluetoothDeviceConnectError",DISCONNECT:"onBluetoothDeviceDisconnectError"});OJ.extendClass("NwBluetoothError",[OjEvent],{_g_p_:{data:null,devices:null},_c:function(d,c,e,b,a){this._s(OjEvent,"_c",[d,b,a]);this._devices=c;this._data=e}},{DETECT_DEVICES:"onBluetoothDetectDevicesError"});OJ.extendClass("NwBluetoothDeviceEvent",[OjEvent],{_g_p_:{data:null,device:null},_c:function(c,d,e,b,a){this._s(OjEvent,"_c",[c,b,a]);this._device=d;this._data=e}},{CONNECT:"onBluetoothDeviceConnect",DISCONNECT:"onBluetoothDeviceDisconnect",RSSI_UPDATE:"onBluetoothDeviceRssiUpdate"});OJ.extendClass("NwBluetoothEvent",[OjEvent],{_g_p_:{data:null,devices:null},_c:function(d,c,e,b,a){this._s(OjEvent,"_c",[d,b,a]);this._devices=c;this._data=e}},{DETECT_DEVICES:"onBluetoothDetectDevices"});OJ.extendManager("BluetoothManager","NwBluetoothManager",[NwManager],{_namespace:"nwBluetooth",_notified:false,_read_callbacks:{},_rssi_callbacks:{},_g_p_:{isAvailable:null},_c:function(a){this._s(NwManager,"_c",[]);NW.addEventListener("nwOnBluetoothCharDiscover",this,"_onCharDiscover");NW.addEventListener("nwOnBluetoothDataSent",this,"_onDataSent");NW.addEventListener("nwOnBluetoothDataReceived",this,"_onDataReceived");NW.addEventListener("nwOnBluetoothDetectDevices",this,"_onDetectDevices");NW.addEventListener("nwOnBluetoothDeviceConnect",this,"_onDeviceConnect");NW.addEventListener("nwOnBluetoothDeviceDisconnect",this,"_onDeviceDisconnect");NW.addEventListener("nwOnBluetoothDeviceRssiUpdate",this,"_onDeviceRssiUpdate")},_notify_missing_bluetooth:function(){if(!this._notified){this._notified=true;WindowManager.alert("Bluetooth services are being requested, however, they are not accessible. Please ensure bluetooth is on and accessible to the application.","Bluetooth Unavailable")}return false},_onCharDiscover:function(a){},_onDataReceived:function(j){var d=j.data,b=NwBluetoothDevice.importData(d.device),h=d.error,a,g=this.dataListenerType(b,d.service,d.characteristic),e=this._read_callbacks[g];if(h){a=new NwBluetoothDeviceError(g)}else{if(e){var f=e.length,c;for(c=0;c<f;c++){e[c](d.data)}delete e[g]}a=new NwBluetoothDeviceEvent(g,b,d.data)}this.dispatchEvent(a)},_onDataSent:function(a){},_onDetectDevices:function(a){var e=a.data,b=e?NwBluetoothDevice.importData(e.devices):null,c=e?e.error:null,d;if(b&&!c){d=new NwBluetoothEvent(NwBluetoothEvent.DETECT_DEVICES,b)}else{d=new NwBluetoothError(NwBluetoothError.DETECT_DEVICES,b)}this.dispatchEvent(d)},_onDeviceConnect:function(a){var d=a.data,c=NwBluetoothDevice.importData(d.device),b=d.error;if(c){this.dispatchEvent(b?c._onConnectError(b):c._onConnect())}},_onDeviceDisconnect:function(a){var d=a.data,c=NwBluetoothDevice.importData(d.device),b=d.error;if(c){this.dispatchEvent(c._onDisconnect(b))}},_onDeviceRssiUpdate:function(j){var c=j.data,b=NwBluetoothDevice.importData(c.device),h=c.error;if(b&&!h){var a=b.uuid,g=c.rssi;;this.dispatchEvent(b._onRssiUpdate(g));var e=this._rssi_callbacks[a],d=0,f=e?e.length:0;for(;d<f;d++){e[d](g)}delete this._rssi_callbacks[a]}},addDataListener:function(d,a,e,b,f){var c=this.dataListenerType(d,a,e);if(!this.hasEventListener(c)){this._comm("addDataListener",[d.uuid,a,e])}return this.addEventListener(c,b,f)},removeDataListener:function(e,a,f,c,g){var d=this.dataListenerType(e,a,f),b=this.removeEventListener(d,c,g);if(!this.hasEventListener(d)){this._comm("removeDataListener",[e.uuid,a,f])}return b},connect:function(b,c){if(!NW.isNative){return this._notify_missing_bluetooth()}var a=[b.uuid];if(!isUndefined(c)){a.append(c)}this._comm("connect",a);return true},disconnect:function(b,c){if(!NW.isNative){return this._notify_missing_bluetooth()}var a=[b.uuid];if(!isUndefined(c)){a.append(c)}this._comm("disconnect",a);return true},dataListenerType:function(b,a,c){return b.uuid+":"+a+":"+c},".isAvailable":function(){return NW.isNative},readData:function(e,a,f,g){if(!NW.isNative){return this._notify_missing_bluetooth()}var b=[e.uuid,a,f],c=b.join(":"),d=this._read_callbacks[c];if(!d){d=this._read_callbacks[c]=[]}d.append(g);this._comm("readData",[e.uuid,a,f])},rssi:function(c,d){if(!NW.isNative){return this._notify_missing_bluetooth()}var a=c.uuid,b=this._rssi_callbacks[a];if(!b){b=this._rssi_callbacks[a]=[]}b.append(d);this._comm("rssi",[a])},scanForDuration:function(a){if(!NW.isNative){return this._notify_missing_bluetooth()}this._comm("scanForDuration",[a]);return true},scanStart:function(){if(!NW.isNative){return this._notify_missing_bluetooth}this._comm("scanStart",[]);return true},scanStop:function(){if(!NW.isNative){return this._notify_missing_bluetooth()}this._comm("scanStop",[]);return true},writeData:function(b,a,d,c){if(!NW.isNative){return this._notify_missing_bluetooth()}this._comm("writeData",[b.uuid,a,d,c])}});OJ.extendClass("NwBooleanProperty",[NwProperty],{_type:NwProperty.INTEGER,_exportValue:function(b,a,c){return b?1:0},_processValue:function(b,a,c){return isTrue(b)}});OJ.extendClass("NwObjectProperty",[NwProperty],{_p_:{namespace:null}});(function(){var f=this;var m;if(typeof(f.require)=="function"){try{var j=f.require("crypto").randomBytes;m=j&&function(){return j(16)}}catch(v){}}if(!m&&f.crypto&&crypto.getRandomValues){var n=new Uint8Array(16);m=function w(){crypto.getRandomValues(n);return n}}if(!m){var b=new Array(16);m=function(){for(var e=0,y;e<16;e++){if((e&3)===0){y=Math.random()*4294967296}b[e]=y>>>((e&3)<<3)&255}return b}}var r=typeof(f.Buffer)=="function"?f.Buffer:Array;var k=[];var l={};for(var t=0;t<256;t++){k[t]=(t+256).toString(16).substr(1);l[k[t]]=t}function p(A,e,B){var y=(e&&B)||0,z=0;e=e||[];A.toLowerCase().replace(/[0-9a-f]{2}/g,function(i){if(z<16){e[y+z++]=l[i]}});while(z<16){e[y+z++]=0}return e}function o(e,z){var y=z||0,A=k;return A[e[y++]]+A[e[y++]]+A[e[y++]]+A[e[y++]]+"-"+A[e[y++]]+A[e[y++]]+"-"+A[e[y++]]+A[e[y++]]+"-"+A[e[y++]]+A[e[y++]]+"-"+A[e[y++]]+A[e[y++]]+A[e[y++]]+A[e[y++]]+A[e[y++]]+A[e[y++]]}var h=m();var u=[h[0]|1,h[1],h[2],h[3],h[4],h[5]];var x=(h[6]<<8|h[7])&16383;var d=0,q=0;function g(J,z,D){var E=z&&D||0;var F=z||[];J=J||{};var C=J.clockseq!=null?J.clockseq:x;var e=J.msecs!=null?J.msecs:new Date().getTime();var I=J.nsecs!=null?J.nsecs:q+1;var y=(e-d)+(I-q)/10000;if(y<0&&J.clockseq==null){C=C+1&16383}if((y<0||e>d)&&J.nsecs==null){I=0}if(I>=10000){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}d=e;q=I;x=C;e+=12219292800000;var H=((e&268435455)*10000+I)%4294967296;F[E++]=H>>>24&255;F[E++]=H>>>16&255;F[E++]=H>>>8&255;F[E++]=H&255;var G=(e/4294967296*10000)&268435455;F[E++]=G>>>8&255;F[E++]=G&255;F[E++]=G>>>24&15|16;F[E++]=G>>>16&255;F[E++]=C>>>8|128;F[E++]=C&255;var B=J.node||u;for(var A=0;A<6;A++){F[E+A]=B[A]}return z?z:o(F)}function c(y,e,C){var z=e&&C||0;if(typeof(y)=="string"){e=y=="binary"?new r(16):null;y=null}y=y||{};var B=y.random||(y.rng||m)();B[6]=(B[6]&15)|64;B[8]=(B[8]&63)|128;if(e){for(var A=0;A<16;A++){e[z+A]=B[A]}}return e||o(B)}var s=c;s.v1=g;s.v4=c;s.parse=p;s.unparse=o;s.BufferClass=r;if(typeof define==="function"&&define.amd){define(function(){return s})}else{if(typeof(module)!="undefined"&&module.exports){module.exports=s}else{var a=f.uuid;s.noConflict=function(){f.uuid=a;return s};f.uuid=s}}}).call(this);OJ.extendClass("NwUuidProperty",[NwProperty],{_p_:{unique:true},_importValue:function(b,a,c){return b?b.toLowerCase():null},generate:function(){return this.$.generate()},"=unique":function(){throw"Cannot set the uniqueness of a uuid. This is a fixed value."}},{generate:function(){return uuid.v4().toLowerCase()}});OJ.extendClass("NwBluetoothDevice",[NwData],{_g_p_:{isConnected:false,rssi:0},_onConnect:function(){this._isConnected=true;var a=new NwBluetoothDeviceEvent(NwBluetoothDeviceEvent.CONNECT,this);this.dispatchEvent(a);return a},_onConnectError:function(a){this._isConnected=false;var b=new NwBluetoothDeviceError(NwBluetoothDeviceError.CONNECT,this);this.dispatchEvent(b);return b},_onDisconnect:function(a){this._isConnected=false;var b=new NwBluetoothDeviceEvent(NwBluetoothDeviceEvent.DISCONNECT,this);this.dispatchEvent(b);return b},_onRssiUpdate:function(a){this._property("rssi",a);var b=new NwBluetoothDeviceEvent(NwBluetoothDeviceEvent.RSSI_UPDATE,this);this.dispatchEvent(b);return b},addDataListener:function(a,c,b,d){return BluetoothManager.addDataListener(this,a,c,b,d)},removeDataListener:function(a,c,b,d){return BluetoothManager.removeDataListener(this,a,c,b,d)},connect:function(a){if(this._isConnected){return}BluetoothManager.connect(this,a)},disconnect:function(a){BluetoothManager.disconnect(this,a)},readData:function(a,b,c){BluetoothManager.readData(this,a,b,c)},writeData:function(a,c,b){BluetoothManager.writeData(this,a,c,b)},title:function(){var a=this.name;return a?a:"Unknown"},".proximity":function(){var a=this.rssi;if(a==0){return -1}var b=Math.pow(10,this.txPowerLevel-a/10);NW.print([a,this.txPowerLevel,Math.sqrt(b)]);return Math.sqrt(b)},".rssi":function(a){if(this.isConnected&&a){BluetoothManager.rssi(this,a)}return this._property("rssi")},".txPowerLevel":function(){var a=this.advertisementData,b=a?a.kCBAdvDataTxPowerLevel:null;if(b){return parseInt(b)}if((b=a["org.bluetooth.characteristic.tx_power_level"])){return parseInt(b)}return undefined},".uuid":function(){var a=this._property("uuid");return a?a.toUpperCase():null}},{KEY:"uuid",DEFINITION:{advertisementData:new NwObjectProperty({label:"Advertisement Data"}),name:new NwTextProperty({label:"Name"}),rssi:new NwIntegerProperty({label:"RSSI"}),uuid:new NwUuidProperty({label:"UUID"}),watchDogRaised:new NwBooleanProperty({label:"Watch Dog Raised"})},TYPE:"BluetoothDevice",key:function(a){return a?a.toUpperCase():null}});OJ.extendClass("NwMarquee",[OjComponent],{_p_:{buttonMode:null,interval:0,nextButtonIcon:null,nextButtonLabel:"Next >",prevButtonIcon:null,prevButtonLabel:"< Prev"},_t:"<div><div var=prerender></div><stack var=container></stack></div>",_c:function(){this._s(OjComponent,"_c",[]);var a=arguments,b=a.length;this.container.allowLooping=true;this.container.addEventListener(OjUiEvent.OVER,this,"_onMouseOver");this.container.addEventListener(OjUiEvent.OUT,this,"_onMouseOut");this.container.addEventListener(OjStackEvent.CHANGE_COMPLETE,this,"_onChange");if(b){if(b>1){if(b>2){this.itemRenderer=a[2]}this.transition=a[1]}this.items=a[0]}this._timer=new OjTimer(this._interval*1000,0);this._timer.addEventListener(OjTimer.TICK,this,"_onTimerTick");this.buttonMode=NwMarquee.HIDE_BUTTONS},_d:function(){this._u("_timer");return this._s(OjComponent,"_d",arguments)},_setIsDisplayed:function(a){if(this._is_displayed==a){return}this._s(OjComponent,"_setIsDisplayed",arguments);if(this._is_displayed){if(this._timer.isPaused()){this.start()}this.redraw()}else{if(this._timer.isRunning()){this._timer.pause()}}},_redrawButtons:function(){if(this._is_displayed){if(this.prevBtn){this.prevBtn.isDisabled=!this._allowLooping&&this._current_index<=0}if(this.nextBtn){this.nextBtn.isDisabled=!this._allowLooping&&this._current_index>=this.numElms-1}return true}return false},_onChange:function(b){var a=this.container,c=b.index,d;this.prerender.children=[(d=a.getElmAt(c-1))==a.active?null:a.renderItem(d),(d=a.getElmAt(c+1))==a.active?null:a.renderItem(d)]},_onTimerTick:function(a){this.next()},_onMouseOut:function(a){if(this._timer.state==OjTimer.PAUSED){this.start()}},_onMouseOver:function(a){if(this._timer.isRunning()){this._timer.pause()}},_onNextClick:function(a){this.next()},_onPrevClick:function(a){this.prev()},next:function(){if(this._timer.isRunning()){this._timer.restart()}this.container.next()},prev:function(){if(this._timer.isRunning()){this._timer.restart()}this.container.prev()},start:function(){if(this._interval){this._timer.start()}},stop:function(){this._timer.stop()},".allowLooping":function(){return this.container.allowLooping},"=allowLooping":function(a){this.container.allowLooping=a;this._redrawButtons()},".alwaysTrans":function(){return this.container.alwaysTrans},"=alwaysTrans":function(a){return this.container.alwaysTrans=a},"=buttonMode":function(a){if(this._buttonMode==a){return}if(this._buttonMode){this.removeCss(this._buttonMode)}this.addCss([this._buttonMode=a]);if(this._buttonMode==this.$.HIDE_BUTTONS){this.removeChild(this.prevBtn);this.removeChild(this.nextBtn)}else{if(!this.prevBtn){this.prevBtn=new OjButton(this._prevButtonLabel,this._prevButtonIcon);this.prevBtn.addCss("prevBtn");this.prevBtn.addEventListener(OjUiEvent.PRESS,this,"_onPrevClick")}this.addChild(this.prevBtn);if(!this.nextBtn){this.nextBtn=new OjButton(this._nextButtonLabel,this._nextButtonIcon);this.nextBtn.addCss("nextBtn");this.nextBtn.addEventListener(OjUiEvent.PRESS,this,"_onNextClick")}this.addChild(this.nextBtn)}},"=interval":function(a){this._interval=a;this._timer.duration=a*1000},"=isDisabled":function(a){if(this._isDisabled==a){return}this._s(OjComponent,"=isDisabled",arguments);if(this._isDisabled&&this._timer.isRunning()){this._timer.pause()}else{if(!this._isDisabled&&this._timer.isPaused()){this.start()}}},".itemRenderer":function(){return this.container.itemRenderer},"=itemRenderer":function(a){this.container.itemRenderer=a},".items":function(){return this.container.elms},"=items":function(a){this.container.elms=a},"=nextButtonIcon":function(a){if(this._nextButtonIcon==a){return}this._nextButtonIcon=a;if(this.nextBtn){this.nextBtn.icon=a}},"=nextButtonLabel":function(a){if(this._nextButtonLabel==a){return}this._nextButtonLabel=a;if(this.nextBtn){this.nextBtn.label=a}},"=prevButtonIcon":function(a){if(this._prevButtonIcon==a){return}this._prevButtonIcon=a;if(this.prevBtn){this.prevBtn.icon=a}},"=prevButtonLabel":function(a){if(this._prevButtonLabel==a){return}this._prevButtonLabel=a;if(this.prevBtn){this.prevBtn.label=a}},".transition":function(){return this.container.transition},"=transition":function(a){return this.container.transition=a}},{HIDE_BUTTONS:"hide-buttons",HOVER_BUTTONS:"hover-buttons",SHOW_BUTTONS:"show-buttons"});OJ.extendClass("NwCarousel",[NwMarquee],{_p_:{viewSize:50},_allow_loop:false,_current_pos:0,_index:null,_offset:0,_tween:null,_view_offset:0,_visable_size:0,_c:function(){this._index={};this._s(NwMarquee,"_c",arguments)},_redrawPosition:function(g){if(!this._collection){return}var d,e,k,j,a,h,c=this._offset+this._view_offset,f=this._collection.length,b=this.container.children;if(g<0){a=Math.ceil((g-c)/this._viewSize);h=Math.ceil((g+c)/this._viewSize)}else{a=Math.signedCeil((g-c)/this._viewSize);h=Math.signedCeil((g+c)/this._viewSize)}for(d=a;d<h;d++){if(d<0){if(this._allow_loop){k=d*this._viewSize;e=(f-1)+(d%f)}else{e=0;k=0}}else{if(d<f){k=(e=d)*this._viewSize}else{if(this._allow_loop){e=d%f}else{e=f-1}k=d*this._viewSize}}if(j=this[e]){j.x=k+this._offset-this._view_offset-g;j.width=this._viewSize;if(this.container.hasChild(j)){b.remove(j)}else{j.addEventListener(OjUiEvent.PRESS,this,"_onViewClick");this.container.addChild(j)}this._index[j.id]=d}}d=b.length;while(d--){b[d].removeEventListener(OjUiEvent.PRESS,this,"_onViewClick");this.container.removeChild(b[d])}this._current_pos=g},redraw:function(){if(this._s(NwMarquee,"redraw",arguments)){this._visable_size=this.container.width;this._offset=this._visable_size/2;this._view_offset=this._viewSize/2;this._allow_loop=this._visable_size<this.numElms()*this._viewSize;this._redrawPosition(this._current_pos);return true}return false},_onTweenTick:function(a){this._redrawPosition(a.value)},_onViewClick:function(a){this.activeIndex=this._index[a.currentTarget.id]},"=activeIndex":function(e){var a,b,d;if(this._activeIndex==e&&this._active){return}if(!this._active){this._activeIndex=e;this._active=this.getElmAt(e);this._redrawPosition(e*this._viewSize);return}var c=this.numElms;this._tween=new OjTween(this._current_pos,(this._current_index=e)*this._viewSize,300,OjEasing.OUT);this._tween.addEventListener(OjTweenEvent.TICK,this,"_onTweenTick");e=e%c;if(e<0){e=c+e}this._activeIndex=e;if(this._active=this.getElmAt(e)){this._tween.start()}else{this._activeIndex=-1}}});OJ.extendClass("NwLayout",[OjActionable],{_p_:{hSpacing:0,target:null,vSpacing:0},_c:function(){this._s(OjActionable,"_c",[]);this._layouts={}},_recalculateLayoutItem:function(a,b){if(this._layouts[a]){return this._layouts[a]}return this._layouts[a]=b.rect},recalculateLayout:function(a){if(!this._target){return}var b=a,f,d,e=false,c=this._target.numElms;for(;b<c;b++){f=this._target.renderItemAt(b);e=!f.parent;if(e){OJ.render(f)}d=this._recalculateLayoutItem(b,f);if(e){f.parent=null}f.x=d.left;f.y=d.top}},getVisible:function(b){var a=this._target.numElms,c=[];for(;a--;){if(b.hitTestRect(this._layouts[a])){c.append(a)}}return c},getItemRectAt:function(a){return this._layouts[a]},"=target":function(a){if(this._target==a){return}this._target=a;this.recalculateLayout(0)}});window.NwILayoutable={};OJ.extendClass("NwColumnLayout",[NwLayout],{_p_:{numCols:1},_c:function(){this._s(NwLayout,"_c",[]);this._col_widths=[0];var a=arguments;if(a.length){this.numCols=a[0]}},_recalculateLayoutItem:function(d,g){var f=this._s(NwLayout,"_recalculateLayoutItem",arguments),a,h;if(!d){a=h=0}else{var c=d%this._numCols,b=!this._col_widths[c]||d<this._numCols?g.width:this._col_widths[c],e=d<this._numCols?null:this._layouts[d-this._numCols];this._col_widths[c]=b;a=(c*b)+(c*this._hSpacing);h=e?e.bottom+this._vSpacing:0}f.left=a;f.top=h;return f},"=numCols":function(a){a=Math.max(a,0);if(this._numCols==a){return}this._numCols=a;this._col_widths=[];for(;a--;){this._col_widths.append(0)}this.recalculateLayout(0)}});OJ.extendComponent("NwScrollPane",[OjView],{_p_:{layout:null,allowScroll:"both"},_custom_scroll:OJ.is_touch_capable&&(OJ.is_mobile||OJ.is_tablet),_multiplier:2,_lastScroll:0,_c:function(){var a=arguments;this._s(OjView,"_c",[]);this._setup();this.addEventListener(OjScrollEvent.SCROLL,this,"_onPaneScroll");if(OJ.is_mobile&&OJ.browser==OJ.SAFARI){this.addEventListener(OjUiEvent.PRESS,this,"_onMobileSafariClick")}this._dims=[];this.layout=a.length?a[0]:new NwColumnLayout();if(OJ.is_mobile){this._multiplier=4}},_d:function(){this._teardown();this._s(OjView,"_d",arguments)},_canScrollX:function(){return this._allowScroll==this.$.X||this._allowScroll==this.$.BOTH},_canScrollY:function(){return this._allowScroll==this.$.Y||this._allowScroll==this.$.BOTH},_onPaneScroll:function(a){var b=(new Date()).getTime();if(b-this._lastScroll>5){this._lastScroll=b;this.redraw()}},_onPaneScrollStart:function(a){},_onPaneScrollMove:function(a){},_onPaneScrollEnd:function(a){},_onMobileSafariClick:function(a){},addEventListener:function(a,c,b){this._s(OjView,"addEventListener",arguments);this._addItemListener(a)},removeEventListener:function(a,c,b){this._s(OjView,"removeEventListener",arguments);this._removeItemListener(a)},redraw:function(){if(this._s(OjView,"redraw",arguments)){var a=this.container,f=this.scrollY,c=this.height,e=this._layout.visible=new OjRect(this.scrollX-a.x,f-a.y,this.width*this._multiplier,c*this._multiplier),d=a.numChildren,b;for(;d--;){if((b=e.indexOf(this.indexOfElm(a.getChildAt(d))))==-1){a.removeChildAt(d)}else{e.removeAt(b)}}for(d=e.length;d--;){a.addChild(this.renderItemAt(e[d]))}if(this.footer){if(f+c<this.footer.y){if(this._footer.parent){}}else{this.footer.addChild(this._footer);this.footer.height=OjStyleElement.AUTO}}if(this.header){if(f>(c=this.header.height)){if(this._header.parent){this.header.height=c;this.header.removeAllChildren()}}else{this.header.addChild(this._header);this.header.height=OjStyleElement.AUTO}}return true}return false},_onItemAdd:function(a){this._onItemChange(a)},_onItemChange:function(a){this._layout.recalculateLayout(a.index);this.container.height=this._layout.getItemRectAt(this.numElms-1).bottom;this.redraw()},_onItemMove:function(a){this._s(OjView,"_onItemMove",arguments);this._onItemChange(a)},_onItemRemove:function(a){this._s(OjView,"_onItemRemove",arguments);this._onItemChange(a)},_onItemReplace:function(a){this._s(OjView,"_onItemReplace",arguments);this._onItemChange(a)},"=layout":function(a){if(this._layout==a){return}(this._layout=a).target=this}},{_TAGS:["scrollpane"],BOTH:"x",X:"x",Y:"y"});OJ.extendClass("NwApiData",[NwData,NwIPersistentData],{_exportProp:function(b,a){if(a==NwApiData.API){return b in this._dirty}return true},_getDeleteRequest:function(d,c){var a=Array.prototype.splice.call(arguments,0);if(a.length<2){var c={};c[this.$.KEY]=this.key();a.append(c)}var b=this._getRequest(this._translateDeleteParam,a);b.request.method=OjUrlRequest.POST;return b},_getLoadRequest:function(c,b){var a=Array.prototype.splice.call(arguments,0);if(a.length<2){var b={};b[this.$.KEY]=this.key();a.append(b)}return this._getRequest(this._translateLoadParam,a)},_getRequest:function(a,b){if(b.length>1){var c,e,f,g,d={};for(c in b[1]){e=a.call(this,c);if(e){f=this._exportValue(c,NwApiData.API,b[1][c]);if(isObject(f)&&(g=this.$.getProperty(c)).flatten){for(c in f){e=a.call(this,g.namespace+"."+c);if(e){d[e]=f[c]}}}else{d[e]=f}}}b[1]=d}return AppManager.apiRequest.apply(AppManager,b)},_getSaveRequest:function(d,c){if(isUndefined(c)){c={};if(!this.isNew()){c[this.$.KEY]=this.key()}for(var a in this._dirty){c[a]=this._data[a]}}var b=this._getRequest(this._translateSaveParam,[d,c]);b.request.method=OjUrlRequest.POST;return b},_importValue:function(c,a,b){this._s(NwData,"_importValue",arguments);if(b==NwApiData.API&&this.$.hasProperty(c)){delete this._dirty[c]}},_processDeleteData:function(a){},_processLoadData:function(a){this.importData(a,NwApiData.API)},_processSaveData:function(a){this.importData(a,NwApiData.API)},_resetLoader:function(){if(this._loader){this._loader.cancel();this._u("_loader")}},_translateDeleteParam:function(b){var a=this.$.EXPORT_MAP;return a[b]?a[b]:b},_translateLoadParam:function(b){var a=this.$.EXPORT_MAP;return a[b]?a[b]:b},_translateSaveParam:function(b){var a=this.$.EXPORT_MAP;return a[b]?a[b]:b},_onDelete:function(a){this._is_loaded=false;this.key(null);this._processDeleteData(this._loader.data);this._u("_loader");this.dispatchEvent(new NwDataEvent(NwDataEvent.DELETE));this.$.dispatchEvent(new NwDataEvent(NwDataEvent.DELETE,this));this._s(NwData,"del",arguments)},_onDeleteFail:function(a){this._u("_loader");this.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.DELETE));this.$.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.DELETE,this))},_onLoad:function(a){this._is_loaded=true;this._processLoadData(this._loader.data);this._u("_loader");this._s(NwData,"_onLoad",arguments)},_onLoadFail:function(a){this._u("_loader");this.dispatchEvent(new NwDataEvent(NwDataErrorEvent.LOAD));this.$.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.LOAD,this))},_onSave:function(a){if(a){var d=a.target,b=d.data;if(d.is("OjRpc")){if(!b||b.error){return this._onSaveFail(a)}b=b.result}this._processSaveData(b);var c,e=d.request.data,f=this.$.EXPORT_MAP;for(c in e){delete this._dirty[f[c]]}if(this._loader==d){this._u("_loader")}}this._s(NwData,"_onSave",arguments)},_onSaveFail:function(a){var e,d;if(a){var c=this._loader,b=c.data;if(c.is("OjRpc")&&b){e=b.error.code;d=b.error.message}this._u("_loader")}this.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.SAVE,this,d,e));this.$.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.SAVE,this,d,e))},del:function(){this._resetLoader();this._loader=this._getDeleteRequest();this._loader.addEventListener(OjEvent.COMPLETE,this,"_onDelete");this._loader.addEventListener(OjEvent.FAIL,this,"_onDeleteFail");this._loader.load()},load:function(){var a=arguments,c=a.length,b=c?a[0]:false;if(this.isNew()||(this._is_loaded&&!b)){return this}this._resetLoader();this._is_loaded=false;this._loader=this._getLoadRequest();this._loader.addEventListener(OjEvent.COMPLETE,this,"_onLoad");this._loader.addEventListener(OjEvent.FAIL,this,"_onLoadFail");this._loader.load()},save:function(){var f=this.isNew(),a=this.isDirty();if(!f&&!a){this._onSave(null);return}this._resetLoader();var c=this._dirty,d=arguments.length,b,e;if(!f&&a&&d){this._dirty={};for(;d--;){if(e=c[(b=arguments[d])]){this._dirty[b]=e}}}this._loader=this._getSaveRequest();this._dirty=c;this._loader.addEventListener(OjEvent.COMPLETE,this,"_onSave");this._loader.addEventListener(OjEvent.FAIL,this,"_onSaveFail");this._loader.load()}},{API:"api",DATA_KEY:"__type__",DEFINITION:{id:new NwUuidProperty()},TYPE:"ApiData",_callApi:function(a,b,e,c,d){return this._callApiWithRequest(AppManager.apiRequest(a,b,e),c,d)},_callApiWithRequest:function(a,b,c){a.addEventListener(OjEvent.COMPLETE,this,b);a.addEventListener(OjEvent.FAIL,this,c);a.load();return a},_onApiFail:function(a,c,e){var b=arguments,d=b.length;if(a){a=OJ.destroy(a)}this.dispatchEvent(new NwDataErrorEvent(c,e,d>3?b[3]:null,d>4?b[4]:null))},_onApiLoad:function(a,e,g){var b=arguments,f=b.length,c=f>3?b[3]:null,h;if(a){h=this.importData(a.target.data,NwApiData.API);if(c){this[g][c]=h}else{this[g]=h}a=OJ.destroy(a)}else{h=c?this[g][c]:this[g]}this.dispatchEvent(new NwDataEvent(e,h,f>4?b[4]:null));return h},load:function(b){if(!b){return null}var a=this.get(b,true);if(a.isLoaded()&&(arguments.length==1||!arguments[1])){this.dispatchEvent(new NwDataEvent(NwDataEvent.LOAD,a))}else{a.load()}return a},ON_SEARCH_LOAD:"onSearchLoad",ON_SEARCH_FAIL:"onSearchFail",_onSearchLoad:function(a){this._search_loader=null;this._onApiLoad(a,this.ON_SEARCH_LOAD,"_search_results")},_onSearchFail:function(a){this._search_loader=null;this._onApiFail(a,this.ON_SEARCH_FAIL,null)},search:function(a){if((!this._search_results||a)&&!this._search_loader){this._search_loader=this._callApi(this._api_endpoint,[],OjUrlRequest.GET,"_onSearchLoad","_onSearchFail")}else{this._onSearchLoad(null)}}});OJ.extendComponent("NwDataEditor",[NwDataListEditor],{_onViewPress:function(a){a.cancel()},_onEditPress:function(a){a.cancel()},_onDeleteConfirm:function(a){if(a.buttonIndex){this._data.del()}},_onDeletePress:function(a){a.cancel();var b=WindowManager.alert(OJ.tokenReplace('Are you sure you want to delete "[%title]"?',"title",this._data.title()),"Confirm Delete",["Yes"],"No");b.addEventListener(OjAlertEvent.BUTTON_PRESS,this,"_onDeleteConfirm")}});OJ.defineClass("NwISelectDataView",{_p_:{"class":NwApiData},_itemRenderer:NwDataEditor,_selectConstructor:function(b,a){this._s(b,"_c",a);this._load_checkpoints.search=false;this.itemRenderer=this._itemRenderer},_selectListeners:function(b,a){switch(a[0]){case"search":return[this._class,ApApiData.ON_SEARCH_LOAD,ApApiData.ON_SEARCH_FAIL]}return this._s(b,"_listeners",a)},_selectLoad:function(b,a){this._s(b,"load",a);this._updateListeners("add","search");this._class.search(true);this.no_results.hide()},_process_data:function(a){return a},_updateDataList:function(a){if(!a||!a.length){this.no_results.show()}else{this.no_results.hide()}this.selector.options=this._process_data(a)},_onSearchSuccess:function(a){var b=a.data;this._updateDataList(b);this._updateListeners("remove","search");this._loadCheckpoint("search")},_onSearchFail:function(a){this._updateListeners("remove","search");this._loadCheckpoint("search");WindowManager.alert("There was an error retrieving the data.","Data Error");this.no_results.show()},".itemRenderer":function(){return this.selector.itemRenderer},"=itemRenderer":function(a){this.selector.itemRenderer=a}});OJ.extendClass("NwSelectDataView",[OjView,NwISelectDataView],{_t:"<div><div var=header><textinput var=search_box></textinput></div><div var=container><label var=no_results>No Results Found</label><selector var=selector selection-renderer=OjCheckedOption selection-max=0></selector></div></div>",_c:function(){this._selectConstructor(OjView,arguments);if(this._dataClass){var a=this._dataClass;this._dataClass=null;this.dataClass=a}},_listeners:function(a){return this._selectListeners(OjView,arguments)},_onItemDelete:function(a){this.selector.options.removeItem(a.data)},_onItemUpdate:function(a){var b=this.selector.options;this._updateDataList(b?b.items:[])},load:function(){return this._selectLoad(OjView,arguments)},"=dataClass":function(a){if(this._dataClass==a){return}if(this._dataClass){this._dataClass.removeEventListener(NwDataEvent.SAVE,this,"_onItemUpdate");this._dataClass.removeEventListener(NwDataEvent.DELETE,this,"_onItemDelete")}if(this._dataClass=a){this._dataClass.addEventListener(NwDataEvent.SAVE,this,"_onItemUpdate");this._dataClass.addEventListener(NwDataEvent.DELETE,this,"_onItemDelete")}}});OJ.extendClass("NwSelectDataForm",[OjForm,NwISelectDataView],{_p_:{property:null},_t:"<div><div class=header><textinput var=search_box></textinput></div><list var=errors item-renderer=OjFormError></list><div var=container><label var=no_results>No Results Found</label><selector var=selector selection-renderer=OjCheckedOption></selector></div><div var=actions class=cf></div></div>",_c:function(){return this._selectConstructor(OjForm,arguments)},_listeners:function(a){return this._selectListeners(OjForm,arguments)},_onSearchSuccess:function(a){this._s(NwISelectDataView,"_onSearchSuccess",arguments);this.selector.value=this._data},load:function(){return this._selectLoad(OjForm,arguments)},"=class":function(a){if(this._class==a){return}this._class=a;this.selector.itemRenderer=this._class.ITEM_RENDERER},".data":function(){return this.selector.value},"=data":function(a){this.selector.value=this._data=a},"=property":function(a){if(this._property==a){return}this._property=a;this.selector.selectionMin=this._property.min;this.selector.selectionMax=this._property.max}});OJ.extendComponent("NwOrderedDataEditor",[OjItemEditor],{_t:"<div><label var=handle class=no-select></label><div var=form></div><div var=actions v-align=m><a var=delete_btn on-press=_onDeletePress>&times;</a></div></div>",_position:-1,_orig_pos:-1,_place_holder:null,_c:function(){this._s(OjItemEditor,"_c",arguments);this.handle.addEventListener(OjDragEvent.START,this,"_onDragStart");this.handle.addEventListener(OjDragEvent.DRAG,this,"_onDrag");this.handle.addEventListener(OjDragEvent.END,this,"_onDragEnd")},_redrawData:function(){if(this._s(OjItemRenderer,"_redrawData",arguments)){var a=this._group.indexOfElm(this._data),b;if(this._data){}this.handle.text=a;return true}return false},_onDeletePress:function(a){var b=this._group;this._group.removeElm(this._data);b.redraw()},_onDragStart:function(b){var a=this.width,d=this.height,c=new OjStyleElement(),e=this.parent;c.addCss("ApRecipeStepPlaceHolder");c.width=a;c.height=d;this.width=a;this.height=a;this.x=this.x;this.pageY=b.pageY+1;this.addCss("drag");this._position=this._orig_pos=this._group.indexOfElm(this._data);e.replaceChild(this,this._place_holder=c);e.addChild(this)},_onDrag:function(b){var d=this.parent,a=this.x,g=d.localY(b.pageY),f=this._position,c=0,e=-1;if(this.y>g){for(f++;f--;){if(d.container.getChildAt(f).hitTestPoint(a,g)){e=f;break}}}else{for(c=d.numElms;f<c;f++){if(d.container.getChildAt(f).hitTestPoint(a,g)){e=f;break}}}this.y=g+1;if(e>-1&&e!=this._position){if(e>this._position){this._position=e++}else{this._position=e}d.insertChild(this._place_holder,e)}},_onDragEnd:function(a){this._u("_place_holder");this._group.moveElm(this._data,this._position);this._group.redraw();this.width=null;this.height=null;this.x=null;this.y=null;this.removeCss("drag");this._position=-1},"=data":function(b){if(this._data==b){return}if(this._form){this._u("_form")}this._s(OjItemEditor,"=data",arguments);if(this._data){var a=this._data.oj_class;this._prop=a.getProperty(a.ORDER_KEY);this._form=this._data.makeForm();this._form.autoUpdate=true;this._form.load();this.form.addChild(this._form)}},".value":function(){return this.item.value},"=value":function(a){this.item.value=a}});OJ.extendComponent("NwOrderedDataForm",[OjForm],{_p_:{parentData:null,property:null,submitLabel:"Save"},_t:"<div><list var=errors item-renderer=OjFormError></list><elist var=container item-editor=NwOrderedDataEditor></elist><div var=actions class=cf><button on-press=_onAddClick>+ Add</button></div></div>",_c:function(a,b){this._s(OjForm,"_c",[]);this.property=b;this.parentData=a},_listeners:function(a){switch(a){case"save":return[this.parentData,NwDataEvent.SAVE,NwDataErrorEvent.SAVE]}return this._s(OjForm,"_listeners",arguments)},_unload:function(){this._s(OjForm,"_unload",arguments);var a=this.numElms;for(;a--;){this.getElmAt(a).reset()}},_updateFormData:function(){var b=this.parentData,e=this.property;if(e&&b){var d=e.value(b),c=d?d.length:0,a=[];for(;c--;){a.unshift(d.getItemAt(c))}a.sort(function(g,f){return g.property(g.oj_class.ORDER_KEY)-f.property(f.oj_class.ORDER_KEY)});this.container.elms=a}},_onAddClick:function(b){var a=this.property.dataClass,c=new a();this.addElm(c);c.property(c.oj_class.ORDER_KEY,this.numElms)},_onSaveFail:function(){this._updateListeners("remove","save");this._hideOverlay();WindowManager.alert("Could not save. Please try again.","Save Error")},_onSaveSuccess:function(){this._updateListeners("remove","save");var a=this.numElms();for(;a--;){this.getElmAt(a).isDirty(false)}this._hideOverlay();if(this._controller){this._controller.removeView(this)}},_onSubmitClick:function(a){if(this.submit()){var b=this.parentData,c=this.property;b.property(c.name,this.elms);if(b.isNew()){this._onSaveSuccess(null)}else{this._updateListeners("add","save");this._showOverlay("Saving");b.save(c.name)}}},"=parentData":function(a){if(this._parentData==a){return}this._parentData=a;this._updateFormData()},"=property":function(a){if(this._property==a){return}this._property=a;this._updateFormData()}});OJ.extendComponent("NwDataInput",[OjInput],{_p_:{dataClass:NwData,formRenderer:NwDataForm,itemEditor:OjItemEditor,property:null,selectRenderer:NwSelectDataForm},_t:"<div><div var=wrapper><label var=label></label><div var=psuedoInput><span var=prefix class=prefix></span><span var=stem><elist var=list on-item-change=_onListChange></elist><label var=dflt>None</label></span><span var=suffix class=suffix></span></div></div><div class=buttons><button var=select_btn on-press=_onSelectClick>@</button><button var=add_btn on-press=_onAddClick>+</button></div></div>",_updateButtons:function(){var a=this._property.max;this.add_btn.isDisabled=a&&a<=this.list.numElms},_onAddClick:function(b){var c=new this._formRenderer(),a=this.controller;c.data=new this.dataClass();c.submitLabel="Create";c.title="Create "+this._class.title();c.addEventListener(NwDataEvent.SAVE,this,"_onAddSave");if(a){a.addView(c)}else{WindowManager.modal(c,c.title,600,500)}},_onAddSave:function(a){this.list.addElm(a.currentTarget.data);this._updateButtons()},_onListChange:function(a){this.dispatchEvent(new OjEvent(OjEvent.CHANGE));this._updateButtons()},_onSelectClick:function(b){var c=new this._selectRenderer(),a=this.controller;c.dataClass=this.dataClass;c.data=this.list.dataProvider;c.property=this._property;c.submitLabel="Save";c.title="Select "+this._class.title();c.addEventListener(OjEvent.SUBMIT,this,"_onSelectSave");if(a){a.addView(c)}else{WindowManager.modal(c,c.title,600,500)}},_onSelectSave:function(a){this.value=a.currentTarget.data},_redrawValue:function(){var a=OjArray.array(this._value);this.list.elms=a},"=dataClass":function(a){if(this._dataClass==a){return}this._dataClass=a;this.list.itemRenderer=a.ITEM_RENDERER;var b=new a();if(b.is(NwApiData)){this.removeCss("no-select")}else{this.addCss("no-select")}},".itemEditor":function(){return this.list.itemEditor},"=itemEditor":function(a){this.list.itemEditor=a},".value":function(){return this.list.elms}},{_TAGS:["datainput"]});OJ.extendComponent("NwOrderedReferenceInput",[OjInput],{_p_:{"class":NwData,formRenderer:NwOrderedDataForm,itemEditor:OjItemEditor,property:null},_c:function(){this._s(OjInput,"_c",arguments);this.psuedoInput.addEventListener(OjUiEvent.PRESS,this,"_onInputClick")},_redrawValue:function(){if(!this.value){this.value=new OjLabel();this.stem.addChild(this.value)}var c=this.property,a=c?c.label:"Available",b="No "+a;if(this._value){b=this._value.length+" "+a}this.value.text=b},_onDataSave:function(a){this._value=a.data.property(this.property.name);this._redrawValue()},_onInputClick:function(c){var b=this.controller;if(b){var a=this.formRenderer,d=this.form.data;b.stack.addElm(new a(d,this.property));d.addEventListener(NwDataEvent.SAVE,this,"_onDataSave")}}});OJ.extendClass("NwDataProperty",[NwObjectProperty],{_p_:{dataClass:NwData,nested:false,inline:false,itemEditor:OjItemEditor,options:null,ordered:false},_c:function(c){var a=this,b=arguments;a.dataClass=c;a.itemEditor=c.ITEM_EDITOR;a.itemRenderer=c.ITEM_RENDERER;a._s(NwObjectProperty,"_c",b.length>1?[b[1]]:[])},_exportSubValue:function(b,a,c){if(b&&isObjective(b)){return(this._nested||this._flatten)?b.exportData():b.key()}return b},_exportValue:function(d,a,e){if(this._max==1){return this._exportSubValue(d,a,e)}var b=[],c=d?d.length:0;for(;c--;){b.unshift(this._exportSubValue(d[c],a,e))}return b},_formatter:function(b,c){var a=arguments.length;return b.call(this,c,a>2?arguments[2]:null,a>3?arguments[3]:NwData.DEFAULT)},_importSubValue:function(c,b,d){if(!c){return null}var a=this.dataClass;if(isObjective(c)&&c.is(a)){return c}if((this._nested||this._flatten)&&b){if(isObject(c)){b.importData(c,d)}else{b.key(c)}return b}return isObject(c)?a.importData(c,d):a.get(c,true)},_importValue:function(g,e,b){var k=this,f=k.max;if(f==1){return k._importSubValue(g,e,b)}var j=e?e.length:0,d=j?e:new OjArray();if(isObjective(g,OjArray)){return g}if(isArray(g)){var c=isArray(g)?g.length:0;c=f==0?c:Math.min(c,f);for(;j>c;){d.removeAt(--j)}for(;c--;){if(c<j){d[c]=k._importSubValue(g[c],d[c],b)}else{d.insertAt(this._importSubValue(g[c],null,b),j)}}return d}if(isObject(g)){var h,a;for(h in g){a=parseInt(h);if(!f||ary.length<f){if(a<j){d[a]=k._importSubValue(g[h],d[a],b)}else{d.append(k._importSubValue(g[h],null,b))}}}return d}return(k.nested||k.flatten)?e:null},_setValue:function(e,c,a){var i=this,h=i.name,b=e[h],d=NwDataEvent,f=OjCollectionEvent;if(b==a){return a}if(isArray(a)){arguments[2]=a=OjArray.array(a)}i._s(NwObjectProperty,"_setValue",arguments);var g="on"+(i.namespace||h).ucFirst()+"Change";if(b){if(b.is(NwData)){b.removeEventListener(d.CHANGE,i,g)}else{if(b.is(OjArray)){b.removeEventListener(f.ITEM_CHANGE,i,g)}}}if(a){if(a.is(NwData)){a.addEventListener(d.CHANGE,i,g)}else{if(a.is(OjArray)){a.addEventListener(f.ITEM_CHANGE,i,g)}}}},makeInput:function(c){var e=this.options,b=this.name,g=this.label,d=this.defaultValue,f=this.min,a=this.itemEditor;if(!c){if(e){if(this.isSingleSelection()){c=new OjSelector(b,g,d);c.selectionRenderer=OjRadioOption}else{if(e.length>10){c=new OjTokenInput(b,g,d)}else{c=new OjSelector(b,g,d)}}c.itemRenderer=this.itemRenderer}else{if(this.ordered){c=new NwOrderedReferenceInput(b,g,d);c.property=this;c.itemEditor=a}else{c=new NwDataInput(b,g,d);c.property=this;c.itemEditor=a}}}if(isObjective(c)&&c.is(NwDataInput)){c.dataClass=this.dataClass}else{if(c.options){c.options=e;c.selectionMin=f?f:(this.required?1:0);c.selectionMax=this.max}}return this._s(NwProperty,"makeInput",[c])},setup:function(e,b){var a=this,c=a.namespace,d,f=(a.nested||a.flatten);a._s(NwObjectProperty,"setup",arguments);if(!c){a.namespace=c=b}c=c.ucFirst();d="on"+c+"Change";if(!e[d]){e[d]=function(g){if(!g||!g.is(NwDataEvent)||f){this._addToDirty(b)}}}},"=dataClass":function(a){if(isString(a)){a=OJ.toClass(a)}if(this._dataClass==a){return}this._dataClass=a},".itemEditor":function(){return this._itemEditor?this._itemEditor:this.dataClass.ITEM_EDITOR},".itemRenderer":function(){return this._itemRenderer?this._itemRenderer:this.dataClass.ITEM_RENDERER}});OJ.extendClass("NwEmailProperty",[NwTextProperty],{_p_:{maxLength:254,minLength:3,unique:true},makeInput:function(b){var a=new OjEmailInput(this.name,this.label,this.defaultValue);a.placeholder=this.placeholder;a.required=this.required;return a},"=maxLength":function(a){throw"Cannot set the max length of an email. This is a fixed value."},"=minLength":function(a){throw"Cannot set the min length of an email. This is a fixed value."}});OJ.extendClass("NwFileProperty",[NwProperty],{_p_:{minSize:0,maxSize:1},_processValue:function(a){if(a){if((this._maxSize&&a.size>this._maxSize)||(this._minSize&&a.size<this._minSize)){}}return a},_valueIsValid:function(a){if(!this._minSize&&isNull(a)){return true}return(!this._minSize||a.size>=this._minSize)&&(!this._maxSize||a.size<=this._maxSize)},makeInput:function(){var b=arguments;if(!b.length){b[0]=new OjFileInput(this._name,this._label);b.length=1}var a=this._s(NwProperty,"makeInput",b);a.minSize=this._minLength;a.maxSize=this._maxLength;a.selectionMax=this._max;return a},"=maxSize":function(a){this._maxSize=Math.max(a,0)},"=minSize":function(a){this._minSize=Math.max(a,0)}});OJ.extendClass("NwMediaProperty",[NwFileProperty],{_p_:{formats:null,missing:null},_c:function(){this.formats=[];this._s(NwFileProperty,"_c",arguments)},_getFormatValue:function(f,e,a){var b=this,d=b.name;if(!a){throw'Property "'+d+'" get not allowed.'}var c=f[a];if(c){return c.call(f)}return b.formatValue(f,e)},_setFormatValue:function(f,e,g,d){var b=this,c=b.name;if(!g){throw'Property "'+c+'" set not allowed.'}var a=f[g];if(a){a.call(f,d)}else{b.formatValue(f,e,d)}return d},_setupFormatFunc:function(d,b,c){var g=this,f=b+"_"+c,a="."+f,e="="+f;Object.defineProperty(d,f,{configurable:true,enumerable:false,get:function(){return g._getFormatValue(this,c,a)},set:function(h){return g._setFormatValue(this,c,e,h)}})},formatValue:function(g,f,d){var b=arguments,h=b.length>2,a=this,e=g[a.name],c=a.missing;if(h){if(!e){g[key]=e={}}return e[f]=b[3]}if(!e){return null}e=e[f];if(!e&&c){if(isString(c)){return c}e=c[f]}return e},setup:function(c,b){var a=this;a._s(NwFileProperty,"setup",arguments);a.formats.forEachReverse(function(d){a._setupFormatFunc(c,b,d)})}});OJ.extendClass("NwOptionProperty",[NwProperty],{_p_:{options:null},_c:function(b){var a=arguments;this._s(NwTextProperty,"_c",a.length>1?[a[1]]:[]);this.options=b},_valueIsValid:function(a){return this._options&&this._options.indexOf(a)>-1},makeInput:function(d){var b=this,c=b.defaultValue,a=new OjComboBox(b.name,b.label,c,b.options);a.placeholder=b.placeholder;a.required=b.required;if(c){a.value=c}return a}});OJ.extendClass("NwPasswordProperty",[NwTextProperty],{});OJ.extendClass("NwTokenProperty",[NwTextProperty],{makeInput:function(c){var b=this,a=new OjEmailInput(b.name,b.label,b.defaultValue);a.placeholder=b.placeholder;a.required=b.required;return a}});OJ.extendClass("NwUrlProperty",[NwTextProperty],{});OJ.extendComponent("NwSelector",[OjSelector],{_p_:{summaryRenderer:null},_selectOption:function(a,b){this._s(OjSelector,"_selectOption",arguments);if(this.summary){this.summary.setData(this._value.clone())}},_unselectOption:function(a,b){this._s(OjSelector,"_unselectOption",arguments);if(this.summary){this.summary.data=this._value.clone()}},_onSummaryClick:function(a){if(isEmpty(this.options)){return}WindowManager.show(WindowManager.makeActionCard(this.input,this._label))},"=summaryRenderer":function(a){if(this._summaryRenderer==a){return}if(this.summary){this.stem.replaceChild(this.summary,this.input);this._u("summary")}if(this._summaryRenderer=a){this.stem.replaceChild(this.input,this.summary=new a(this,this._value));this.summary.addEventListener(OjUiEvent.PRESS,this,"_onSummaryClick")}}});OJ.extendClass("NwDataItemRenderer",[OjItemRenderer],{_onDataChange:function(a){this._redrawData()},_redrawData:function(){if(this._s(OjItemRenderer,"_redrawData",arguments)){this.text=this._data?this._data.title():"";return true}return false},"=data":function(a){if(this._data){this._data.removeEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}this._s(OjItemRenderer,"=data",arguments);if(this._data){this._data.addEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}}});