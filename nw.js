"use strict";window.NW=(function Nw(){return new OjActionable({_alerts:{},_analytics:null,_callbacks:{},_gateway:null,_is_native:false,_scroll_top:0,_scroll_left:0,_keyboard_visible:false,_old_trace:null,CONFIRM:"nwConfirm",STATUS_BAR_CHANGE:"onStatusBarChange",STATUS_BAR_NONE:-1,STATUS_BAR_DEFAULT:0,STATUS_BAR_BLACK_TRANSLUCENT:1,STATUS_BAR_BLACK_OPAQUE:2,PORTRAIT:1,PORTRAIT_UPSIDE_DOWN:2,LANDSCAPE_LEFT:3,LANDSCAPE_RIGHT:4,_call:function(b,d){var a;if(isFunction(this[b])){b=(a=this)[b]}else{var c=b.split(".");if(c.length==1){a=window}else{c.pop();a=OJ.stringToVar(c)}b=OJ.stringToVar(b)}if(a&&isFunction(b)){return toJson(OjObject.exportData(b.apply(a,d?d:[])))}return null},_triggerEvent:function(a,b){this.dispatchEvent(new NwEvent(a,false,false,b))},_trace:function(d){if(OJ.getMode()!=OJ.DEV){return}var c=arguments.length,b;if(c<2){NW.trace(d)}else{var a=[];for(b=0;b<c;b++){NW.trace(arguments[b])}}},_onKeyboardHide:function(a){this._keyboard_visible=false;OJ.setScrollTop(this._scroll_top);OJ.setScrollLeft(this._scroll_left)},_onKeyboardShow:function(a){if(!this._keyboard_visible){this._scroll_top=OJ.getScrollTop();this._scroll_left=OJ.getScrollLeft()}this._keyboard_visible=true},getGateway:function(){return this._gateway},getMaxSize:function(){if(!this._is_native){return null}return this.comm("maxSize",[],false).load()},setMaxSize:function(b,a){if(this._is_native){this.comm("maxSize",[b,a]).load()}},getMinSize:function(){if(!this._is_native){return null}return this.comm("minSize",[],false).load()},setMinSize:function(b,a){if(this._is_native){this.comm("minSize",[b,a]).load()}},getSupportedOrientations:function(){if(!this._is_native){return null}return this.comm("supportedOrientations",[],false).load()},setSupportedOrientations:function(a){if(this._is_native){this.comm("supportedOrientations",[a]).load()}},alert:function(a){if(this._is_native){var b=this.comm("alert",[a.getTitle(),a.getContent(),a.getButtons(),a.getCancelLabel()]);this._alerts[b.getId()]=a;return b.load()}},browser:function(a){if(this._is_native){return this.comm("browser",Array.array(arguments)).load()}},comm:function(b,a){return new NwRpc("http://native.web/comm",b,a,OjRpc.JSON,arguments.length>2?arguments[2]:true)},isNative:function(){if(arguments.length){if(this._is_native=!isEmpty(this._gateway=arguments[0])){if(OJ.isReady()){this.comm("ready",[]).load()}document.documentElement.style.webkitTouchCallout=document.body.style.webkitTouchCallout=document.body.style.KhtmlUserSelect="none";document.documentElement.style.webkitTapHighlightColor="rgba(0,0,0,0)"}else{if(this._old_trace){window.trace=this._old_trace;this._old_trace=null}}}return this._is_native},call:function(a){if(this._is_native){return this.comm("call",[a]).load()}},email:function(a){if(this._is_native){return this.comm("email",[a]).load()}},trace:function(a){if(this._is_native){return this.comm("trace",[a]).load()}},trackTimed:function(a,b){},txt:function(a,b){if(this._is_native){return this.comm("txt",[a,b]).load()}},_onOjLoad:function(a){OJ.removeEventListener(OjEvent.LOAD,this,"_onOjLoad");},_onOjReady:function(a){OJ.removeEventListener(OjEvent.READY,this,"_onOjReady");if(this._is_native){this.comm("ready",[]).load()}}})})();OJ.addEventListener(OjEvent.LOAD,NW,"_onOjLoad");OJ.addEventListener(OjEvent.READY,NW,"_onOjReady");OJ.extendClass(OjActionable,"NwSession",{_p_:{data:null,token:null,user:null},_class_path:"nw.app.NwSession",_c:function(){this._s("NwSession","_c",[]);this._data={};var a=arguments.length;if(a){this.setToken(arguments[0]);if(a>1){this.setData(arguments[1])}}},exportData:function(){var a=this._s("NwSession","exportData",arguments);a.data=this._data?OjObject.exportData(this._data):{};a.token=this._token;a.user=this._user?this._user.exportData():null;return a},importData:function(a){this._data=a&&a.data?OjObject.importData(a.data):{};this._token=a&&a.token?a.token:null;this._user=a&&a.user?OjObject.importData(a.user):null},save:function(){this.dispatchEvent(new OjEvent(OjEvent.CHANGE))},get:function(a){return this._data[a]},set:function(a,b){if(this._data[a]==b){return}this._data[a]=b;this.save()},unset:function(a){delete this._data[a];this.save()},setData:function(a){if(this._data==a){return}this._data=a?a:{};this.save()},setToken:function(a){if(this._token==a){return}this._token=a;this.save()},setUser:function(a){if(this._user==a){return}this._user=a;this.save()}});OJ.extendManager("WindowManager",OjWindowManager,"NwWindowManager",{alert:function(c,b){var a=this._alert.apply(this,arguments);if(isUndefined(NW.alert(a))){this.show(a)}return a},browser:function(a,c){var b;if(isUndefined(b=NW.browser(a,c,true))){return this._s("NwWindowManager","browser",arguments)}return b}});OJ.extendClass(OjUrlLoader,"NwUrlLoader",{_async:true,_is_multipart:false,_loadMultiPartRequest:function(){if(NW.isNative()){this._is_multipart=true;return this._load()}this._s("NwUrlLoader","_loadMultiPart",arguments)},_xhrFormat:function(){if(this._is_multipart){this._xhr.setRequestHeader("content-type",OjUrlLoader.JSON);return}this._s("NwUrlLoader","_xhrFormat",arguments)},_xhrOpen:function(){if(this._is_multipart){return this._xhr.open(OjUrlRequest.POST,"http://native.web/request",this._async)}this._s("NwUrlLoader","_xhrOpen",arguments)},_xhrSend:function(){if(this._is_multipart){return this._xhr.send(toJson({url:this._request.toString(),headers:this._request.getHeaders(),method:this._request.getMethod(),data:this._request.getData(),files:this._request.getFiles()}))}this._s("NwUrlLoader","_xhrSend",arguments)}});OJ.extendClass(OjUrlRequest,"NwUrlRequest",{_p_:{priority:0,method:OjUrlRequest.POST,weight:0},_c:function(){this._s("NwUrlRequest","_c",arguments);this.setContentType(OjUrlRequest.JSON)}});OJ.extendManager("CacheManager",OjCacheManager,"NwCacheManager",{_is_native:false,_c:function(a){this._s("NwCacheManager","_c",[]);if(this._is_native=NW.isNative()){}this._policies=a._policies;this._cache_size=a._cache_size},getNativeData:function(a){},setNativeData:function(a,b){},unsetNativeData:function(a){}});OJ.extendClass(OjView,"NwApp",{_g_p_:{maxWidth:null,maxHeight:null,minWidth:320,minHeight:320,session:null,systemBar:"appSystemBarDefault",url:null},_api_endpoint:"/",_api_request_type:OjUrlRequest.QUERY_STRING,_api_response_type:null,_has_mobile_layout:false,_has_tablet_layout:false,_is_logged_in:false,_orientations:null,_ready:false,_scale:1,_timer:null,_acl:null,_c:function(){this._s("NwApp","_c",arguments);var a=HistoryManager.get();this._url=a.getProtocol()+"://"+a.getHost();if((OJ.isMobile()&&this._has_mobile_layout)||(OJ.isTablet()&&this._has_tablet_layout)){this.setSystemBar(NwApp.SYSTEM_BAR_DEFAULT);this._scale=OJ.getPixelRatio();OJ.meta("viewport","initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no");OJ.meta("apple-mobile-web-app-capable","yes")}if(this._orientations){NW.setSupportedOrientations(this._orientations)}if(this._minWidth&&this._minHeight){NW.setMinSize(this._minWidth,this._minHeight)}if(this._maxWidth&&this._maxHeight){NW.setMaxSize(this._maxWidth,this._maxHeight)}this._acl={}},_buildApiUrl:function(a){return this._api_endpoint+String.string(a)},_login:function(){this._is_logged_in=true;this.dispatchEvent(new OjEvent(NwApp.LOGIN));AppManager.dispatchEvent(new OjEvent(NwApp.LOGIN))},_loginFail:function(){this._is_logged_in=false;this.dispatchEvent(new OjEvent(NwApp.LOGIN_FAIL));AppManager.dispatchEvent(new OjEvent(NwApp.LOGIN_FAIL))},_logout:function(){this._is_logged_in=false;this.dispatchEvent(new OjEvent(NwApp.LOGOUT));AppManager.dispatchEvent(new OjEvent(NwApp.LOGOUT))},_logoutFail:function(){this.dispatchEvent(new OjEvent(NwApp.LOGOUT_FAIL));AppManager.dispatchEvent(new OjEvent(NwApp.LOGOUT_FAIL))},_makeSession:function(){return new NwSession()},_onSaveSession:function(a){CacheManager.setData(this.className(),this._session)},_onSessionChange:function(a){this._timer.restart()},apiRequest:function(d,c){var b=arguments.length;var a=new NwUrlLoader(new NwUrlRequest(this._buildApiUrl(d),c,this._api_request_type,b>2?arguments[2]:OjUrlRequest.GET),b>3?arguments[3]:true);a.setContentType(this._api_response_type);return a},hideLoading:function(){return this._hideOverlay()},init:function(){if(!(this._session=CacheManager.getData(this.className()))){this._session=this._makeSession()}this._timer=new OjTimer(500,1);this._timer.addEventListener(OjTimer.COMPLETE,this,"_onSaveSession");this._session.addEventListener(OjEvent.CHANGE,this,"_onSessionChange");this.redraw();return this._session},isLoggedIn:function(){return this._is_logged_in},login:function(){},logout:function(){},showLoading:function(){return this._showOverlay.apply(this,arguments)},setSystemBar:function(b){this._systemBar=b;if(NwApp.OS==NwApp.IOS){var a;switch(this._systemBar){case NwApp.SYSTEM_BAR_BLACK:a="black";break;case NwApp.SYSTEM_BAR_BLACK_NONE:case NwApp.SYSTEM_BAR_BLACK_TRANS:a="black-translucent";break;default:a="default";break}OJ.meta("apple-mobile-web-app-status-bar-style",a)}}},{LOGIN:"onLogin",LOGIN_FAIL:"onLoginFail",LOGOUT:"onLogout",LOGOUT_FAIL:"onLogoutFail",SYSTEM_BAR_BLACK:"appSystemBarBlack",SYSTEM_BAR_BLACK_TRANS:"appSystemBarBlackTranslucent",SYSTEM_BAR_DEFAULT:"appSystemBarDefault",SYSTEM_BAR_NONE:"appSystemBarNone"});OJ.extendManager("AppManager",OjActionable,"NwAppManager",{_p_:{app:null,session:null,user:null},_oj_ready:false,_c:function(){this._s("NwAppManager","_c",arguments);if(OJ.isReady()){this._onOjReady(null)}else{OJ.addEventListener(OjEvent.READY,this,"_onOjReady")}},_initApp:function(){if(this._oj_ready&&this._app&&OJ.isSupported()){this._session=this._app.init()}},_onOjReady:function(a){if(!this._oj_ready){this._oj_ready=true;OJ.removeEventListener(OjEvent.READY,this,"_onOjReady");this._initApp()}},apiRequest:function(b,a){if(!this._app){throw new Error("No application initialized.")}return this._app.apiRequest.apply(this._app,arguments)},getSession:function(){return this._app.getSession()},getUser:function(){var a=this.getSession();return a?a.getUser():null},hideLoading:function(){this._app.hideLoading()},init:function(a){if(arguments.length){this._app=arguments[0];this._initApp()}return this},isLoggedIn:function(){return this._app.isLoggedIn()},login:function(){return this._app.login.apply(this._app,arguments)},logout:function(){return this._app.logout.apply(this._app,arguments)},showLoading:function(){this._app.showLoading.apply(this._app,arguments)},userIsAdmin:function(){var a=arguments.length?arguments[0]:this.getUser();var b=a?a.getRoles():null;return b&&b.indexOf("admin")>-1}});OjStyleElement.registerComponentTag("app",function(c){var a=window[c.getAttribute("class-name")];var b=new a();AppManager.init(b);return b});OJ.extendClass(OjEvent,"NwEvent",{_g_p_:{data:null},_c:function(a){var b=arguments.length;this._s("NwEvent","_c",b>3?[].slice.call(arguments,0,3):arguments);if(b>3){this._data=arguments[3]}}});OJ.extendClass(OjRpc,"NwRpc",{_g_p_:{gateway:null},_c:function(a,c,b){this._s("NwRpc","_c",arguments);this._request.getData()["gateway"]=NW.getGateway()}});OJ.extendClass(OjObject,"NwAnalyticsData",{_p_:{date:null},_c:function(){this._s("NwAnalyticsData","_c",[]);this._date=new Date()}});OJ.extendClass(NwAnalyticsData,"NwAnalyticsAction",{_p_:{category:null,isBounce:false,params:null,name:null},_c:function(b){this._s("NwAnalyticsAction","_c",[]);this.setName(b);var a=arguments,c=a.length;if(c>1){this.setCategory(a[1]);if(c>2){this.setParams(a[2]);if(c>3){this.setIsBounce(a[3])}}}}});OJ.extendClass(OjEvent,"NwAnalyticsEvent",{_g_p_:{data:null},_c:function(a,b){this._s("NwAnalyticsEvent","_c",[a,false,true]);this._data=b}},{ACTION:"onAnalyticsAction",MESSAGE:"onAnalyticsMessage",VIEW:"onAnalyticsView"});OJ.extendClass(NwAnalyticsData,"NwAnalyticsMessage",{_p_:{},_c:function(){this._s("NwAnalyticsMessage","_c",[])}});OJ.extendClass(NwAnalyticsData,"NwAnalyticsView",{_p_:{title:null,path:null},_c:function(){this._s("NwAnalyticsView","_c",[]);var a=arguments,b=a.length;if(b){this.setPath(a[0]);if(b>1){this.setTitle(a[1])}}},setPath:function(a){if(this._path==a){return}if((this._path=a)&&a.charAt(0)!="/"){this._path="/"+a}}});OJ.extendManager("Analytics",OjActionable,"NwAnalytics",{_c:function(){this._s("NwAnalytics","_c",[])},enableEngine:function(a){a.enable()},disableEngine:function(a){a.disable()},log:function(a){this.dispatchEvent(new NwAnalyticsEvent(NwAnalyticsEvent.MESSAGE,new NwAnalyticsMessage(a)))},trackEvent:function(d){var a=arguments,b=a.length,c=new NwAnalyticsAction(d);if(b>1){c.setCategory(a[1]);if(b>2){c.setParams(a[2]);if(b>3){c.setIsBounce(a[3])}}}this.dispatchEvent(new NwAnalyticsEvent(NwAnalyticsEvent.ACTION,c))},trackView:function(){var a=arguments,b=a.length,c=new NwAnalyticsView();if(b){c.setPath(a[0]);if(b>1){c.setTitle(a[1])}}this.dispatchEvent(new NwAnalyticsEvent(NwAnalyticsEvent.VIEW,c))}});OJ.extendClass(OjActionable,"NwAnalyticsEngine",{_queue:null,_processing:false,_c:function(){this._s("NwAnalyticsEngine","_c",[]);this._queue=new OjCollection();if(!this.$._HAS_LIBRARY){this._loadLibrary()}this._init()},_init:function(){},_loadLibrary:function(){this.$._HAS_LIBRARY=true},_processActionItem:function(a){return false},_processItem:function(a){return false},_processQueue:function(){if(this._processing){return}this._processing=true;var c=this._queue.numItems(),b,a;for(;c--;){a="_processItem";b=this._queue.getItemAt(c);switch(b.getType()){case NwAnalyticsEvent.ACTION:a="_processActionItem";break;case NwAnalyticsEvent.MESSAGE:a="_processMessageItem";break;case NwAnalyticsEvent.VIEW:a="_processViewItem";break}if(this[a](b)){this._queue.removeItemAt(c)}}this._processing=false},_processMessageItem:function(a){return false},_processViewItem:function(a){return false},_onAnalyticsEvent:function(a){this._queue.addItemAt(a,0);this._processQueue()},disable:function(){Analytics.removeEventListener(NwAnalyticsEvent.ACTION,this,"_onAnalyticsEvent");Analytics.removeEventListener(NwAnalyticsEvent.MESSAGE,this,"_onAnalyticsEvent");Analytics.removeEventListener(NwAnalyticsEvent.VIEW,this,"_onAnalyticsEvent")},enable:function(){Analytics.addEventListener(NwAnalyticsEvent.ACTION,this,"_onAnalyticsEvent");Analytics.addEventListener(NwAnalyticsEvent.MESSAGE,this,"_onAnalyticsEvent");Analytics.addEventListener(NwAnalyticsEvent.VIEW,this,"_onAnalyticsEvent")},log:function(){},track:function(a,b){this._onAnalyticsEvent(new NwAnalyticsEvent(NwAnalyticsEvent.TACK_EVENT,a,b))}},{_HAS_LIBRARY:false});OJ.extendClass(NwAnalyticsEngine,"NwGoogleAnalytics",{_g_p_:{key:null,namespace:null},_name:null,_c:function(a,b){this._key=a;this._namespace=b;this._s("NwGoogleAnalytics","_c",arguments)},_call:function(){var a=arguments;if(this._name){a[0]=this._name+"."+a[0]}window.ga.apply(window.ga,a)},_init:function(){var a={},b=window.ga.getAll?window.ga.getAll():null;if(!isEmpty(b)){a.name=tthis._name=this.id()}window.ga("create",this._key,this._namespace,a)},_loadLibrary:function(){this._s("NwGoogleAnalytics","_loadLibrary",[]);var a=window;a.GoogleAnalyticsObject="ga";a.ga=function(){(a.ga.q=a.ga.q||[]).push(arguments)};a.ga.l=1*new Date();OJ.addJsFile("//www.google-analytics.com/analytics.js",true)},_processActionItem:function(a){var e=a.getData(),d=e.getCategory(),f=e.getParams(),b={eventCategory:d?d:"misc",eventAction:e.getName(),nonInteraction:!e.getIsBounce()};if(f){var c;for(c in f){b.eventLabel=c;b.eventValue=parseInt(f[c]);break}}this._send("event",b);return true},_processViewItem:function(a){var c=a.getData(),b={page:c.getPath(),title:c.getTitle()};this._send("pageview",b);return true},_send:function(b,a){a.hitType=b;this._call("send",a)}});OJ.extendClass(OjEvent,"NwNavRouteEvent",{_g_p_:{"arguments":null},_c:function(b){var c=arguments.length,a=[b,true,false];if(c>1){this._arguments=arguments[1];if(c>2){a[2]=arguments[2];if(c>3){a[3]=arguments[3]}}}else{this._arguments=[]}this._s("NwNavRouteEvent","_c",a)}},{LOAD:"onRouteLoad",CHANGE:"onRouteChange"});OJ.extendClass(OjActionable,"NwNavRoute",OJ.implementInterface(OjICollection,{_p_:{"arguments":null,icon:null,parent:null,path:null,items:null,title:null,viewClassName:null,viewClassPath:null},_active:false,_path_match:null,_view:null,_c:function(b){this._s("NwNavRoute","_c",[]);this.setPath(b);var a=arguments.length;if(a>1){this.setTitle(arguments[1]);if(a>2){this.setIcon(arguments[2]);if(a>3){this.setViewClassPath(arguments[3]);if(a>4){this.setViewClassName(arguments[4]);if(a>5){this.setItems(arguments[5])}}}}}},_d:function(){OJ.destroy(this._items);return this._s("NwNavRoute","_d",arguments)},_onItemAdd:function(a){a.getItem().setParent(this);this.dispatchEvent(new NwNavRouteEvent(NwNavRouteEvent.CHANGE))},_onItemRemove:function(a){a.getItem().setParent(null);this.dispatchEvent(new NwNavRouteEvent(NwNavRouteEvent.CHANGE))},_onItemReplace:function(a){a.getItem().setParent(this);a.getOldItem().setParent(null);this.dispatchEvent(new NwNavRouteEvent(NwNavRouteEvent.CHANGE))},_getItemByPath:function(f,a){var e,b,d=[],g,c={};for(e=a.length;e--;){b=a[e];if(g=b.pathMatchQuality(f)){if(!c[g]){c[g]=b}if(g==1){return c}}d=b.getItems().concat(d)}if(d.length){return OJ.merge(c,this._getRouteByPath(f,d))}return c},_prepareItems:function(){if(this._items){return}this._items=new OjCollection();this._items.setAllowDuplicate(false);this._items.addEventListener(OjCollectionEvent.ITEM_ADD,this,"_onItemAdd");this._items.addEventListener(OjCollectionEvent.ITEM_REMOVE,this,"_onItemRemove");this._items.addEventListener(OjCollectionEvent.ITEM_REPLACE,this,"_onItemReplace")},defaultItem:function(){return this.numItems()?this.getItemAt(0):null},getItemByPath:function(b){var a=this.numItems()?this._getItemByPath(b,this.getItems()):{};if(a["1"]){return a["1"]}var d,c=99999;for(d in a){if(c>(d=parseInt(d))){c=d}}return c==99999?null:a[c]},dispatchEvent:function(a){this._s("NwNavRoute","dispatchEvent",arguments);if(this._parent){this._parent.dispatchEvent(a)}},hasChildRoute:function(a){var b=this.numItems(),c;for(;b--;){c=this.getItemAt(b);if(c==a){return true}}b=this.numItems();for(;b--;){c=this.getItemAt(b);if(c.hasChildRoute(a)){return true}}return false},hasParentRoute:function(a){var b=this;while(b&&(b=b.getParent())){if(b==a){return true}}return false},isActive:function(){if(arguments.length&&this._active!=arguments[0]){this._active=arguments[0]}return this._active},load:function(){this.dispatchEvent(new NwNavRouteEvent(NwNavRouteEvent.LOAD,Array.array(arguments)))},pathIsMatch:function(b){if(b){var a=b.match(this._path_match);return a&&a.length&&a[0]==b}return false},pathMatchQuality:function(a){if(this._path==a){return 1}if(this.pathIsMatch(a)){return 2+Math.abs(this._path.split("/").length-a.split("/").length)}return 0},pathWithArguments:function(c){var g=this._path;if(c.length){var f=g.split("/"),d,b=0,e=f.length,a=c.length;for(d=0;d<e;d++){if(f[d]=="*"){f[d]=b<a?c[b++]:""}}g=f.join("/")}return g},setIcon:function(a){if(this._icon!=a){this._icon=a}},setParent:function(a){if(this._parent!=a){this._parent=a}},setPath:function(a){if(this._path!=a){this._path=a;this._path_match=a.replace(/\*/g,"[^ ]*")}},setTitle:function(a){if(this._title!=a){this._title=a}},getView:function(){if(this._view||!this._viewClassName||!this._viewClassPath){return this._view}var a=OJ.toClass(this._viewClassName);if(!a){a=OJ.toClass(this._viewClassName)}this._view=new a(this);return this._view}}));OJ.extendClass(OjComponent,"NwNavController",OJ.implementInterface(OjINavController,{_p_:{routing:null},_active:null,_active_index:-1,_active_view:null,_c:function(){this._s("NwNavController","_c",[]);this.setVAlign(OjStyleElement.MIDDLE);this._history=[];var a=arguments.length;if(a){this.setStack(arguments[0]);if(a>1){this.setRouting(arguments[1])}}HistoryManager.addEventListener(HistoryManager.CHANGE,this,"_onHashChange")},_d:function(){HistoryManager.removeEventListener(HistoryManager.CHANGE,this,"_onHashChange");this._cleanupStack();if(this._routing){this._routing.removeEventListener(OjEvent.CHANGE,this,"_onRoutingChange");var a=HistoryManager.get();a.setHashParam(this.getId(),null);OJ.open(a)}return this._s("NwNavController","_d",arguments)},_getDefaultRoute:function(){return this._routing},_getRouteByPath:function(f,a){var e,b,d=[],g,c={};for(e=a.length;e--;){b=a[e];if(g=b.pathMatchQuality(f)){if(!c[g]){c[g]=b}if(g==1){return c}}d=b.getItems().concat(d)}if(d.length){return OJ.merge(c,this._getRouteByPath(f,d))}return c},_load:function(b,a){traceGroup('View Load "'+b+'"');this._active_view=a.getView();if(!this._stack.hasElm(this._active_view)){this._stack.addElm(this._active_view)}this._stack.setActive(this._active_view);this._active_view.addEventListener(NwNavView.LOAD,this,"_onViewLoadComplete");this._active_view.load.apply(this._active_view,[b,b.charAt(0)=="/"?b.substring(1).split("/"):b.split("/")]);this._active=a;this.dispatchEvent(new OjEvent(OjEvent.CHANGE))},_refreshStack:function(){if(this._stack){var b=this._stack.numElms(),a;for(;b--;){a=this._stack.getElmAt(b).getRoute();if(this._routing&&(this._routing==a||this._routing.hasChildRoute(a))){continue}this._stack.removeElmAt(b)}if(this._routing&&!this._active){this._onHashChange(null)}}},_onHashChange:function(a){if(this._routing){var e=this.getId();var c=HistoryManager.get();var d=c.getHashParam(e);var b=this._getDefaultRoute();if(d){b=this.getRouteByPath(d)}else{d=b.getPath()}if(!this._active||this._active!=b){if(b){if(!this._stack){return}this._load(d,b)}else{if(this._active){this.loadRoute(this._active)}}}}},_onRoutingLoad:function(a){this.loadRoute(a.getTarget(),a.getArguments())},_onRoutingChange:function(a){this._refreshStack()},_onViewLoadComplete:function(a){traceGroup();if(!this._active_view){return}this._active_view.removeEventListener(NwNavView.LOAD,this,"_onViewLoadComplete")},loadPath:function(b){var a=HistoryManager.get();a.setHashParam(this.getId(),b);OJ.open(a)},loadRoute:function(a){this.loadPath(a.pathWithArguments(arguments.length>1?arguments[1]:[]))},getRouteByPath:function(b){if(!this._routing){return null}var a=this._getRouteByPath(b,this._routing.getItems());if(a["1"]){return a["1"]}var d,c=99999;for(d in a){if(c>(d=parseInt(d))){c=d}}if(c==99999&&this._routing.pathIsMatch(b)){return this._routing}return a[c]},getActive:function(){return this._active},getActiveIndex:function(){return this._active_index},setRouting:function(a){if(this._routing==a){return}if(this._routing){this._routing.removeEventListener(NwNavRouteEvent.LOAD,this,"_onRoutingLoad")}if(this._routing=a){this._routing.addEventListener(NwNavRouteEvent.LOAD,this,"_onRoutingLoad");this._routing.addEventListener(NwNavRouteEvent.CHANGE,this,"_onRoutingChange")}this._refreshStack()},setStack:function(a){if(this._stack==a){return}if(this._stack){this._cleanupStack()}this._stack=a;this._setupStack()}}));OJ.extendClass(NwNavController,"NwFlowNavController",OJ.implementInterface(OjIFlowNavController,{_history:null,_c:function(){this._history=[];this._s("NwFlowNavController","_c",arguments)},_load:function(c,a){var b=this._history.indexOf(c);if(b==-1){this._history.push(c)}else{this._history=this._history.slice(0,b+1)}return this._s("NwFlowNavController","_load",arguments)},back:function(){this._s("NwFlowNavController","back",arguments);var a=this._history.length;if(a>1){this.loadPath(this._history[a-2])}}}));OJ.extendClass(NwApp,"NwFlowedApp",{nav:null,_routing:null,stack:null,_c:function(){this._s("NwFlowedApp","_c",arguments);this.stack=new OjStack(OjStack.SLIDE_HORZ,250);this.stack.addCss("stack");this.addChild(this.stack);this.nav=new NwFlowNavController(this.stack);this.nav.setId("nav");this.nav.addCss("nav");this.addChildAt(this.nav,0);this._routing=new NwNavRoute("/","Home")},init:function(){var a=this._s("NwFlowedApp","init",arguments);if(this.nav){this.nav.setRouting(this._routing)}return a},load:function(a){if(isString(a)||(isObjective(a)&&a.is("OjUrl"))){this.nav.loadPath(a)}else{this.nav.loadRoute(a)}}});OJ.extendClass(NwNavController,"NwTabNavController",{_getDefaultRoute:function(){return this._routing.getItemAt(0)},_load:function(b,a){if(this._active_index>-1){this.getElmAt(this._active_index).setIsActive(false)}this._s("NwTabNavController","_load",arguments);this.getElmAt(this._active_index=this._routing.indexOfItem(this._active)).setIsActive(true)},_refreshStack:function(){var d=this.numElms(),a=this._routing.numItems(),e=d-a,c,b;for(;d--;){if(d>=a){this.removeElmAt(d);continue}b=this._routing.getItemAt(d);if(b==this._active){this._active_index=d}c=this.getElmAt(d);c.setIcon(b.getIcon());c.setLabel(b.getTitle());c.setWidth((1/a)*100,"%");c.setIsActive(b==this._active)}if(e<0){for(;e++;){b=this._routing.getItemAt((a-1)+e);this.addElm(c=new OjButton(b.getTitle(),b.getIcon()));c.setWidth((1/a)*100,"%");c.addEventListener(OjMouseEvent.CLICK,this,"_onTabClick")}}this._s("NwTabNavController","_refreshStack",arguments)},_onTabClick:function(a){var b=this._routing.getItemAt(this.indexOfElm(a.getCurrentTarget()));this.loadRoute(b)},loadRoute:function(a){if(a==this._routing){arguments[0]=this._getDefaultRoute()}if(arguments[0]){this._s("NwTabNavController","loadRoute",arguments)}}});OJ.extendClass(NwApp,"NwTabbedApp",{_routing:null,_c:function(){this._s("NwTabbedApp","_c",arguments);this.addChild(this.stack=new OjStack(OjStack.FADE,250));this.stack.addCss("stack");this.addChild(this.nav=new NwTabNavController(this.stack));this.nav.setId("nav");this.nav.addCss("nav");this.nav.addEventListener(OjEvent.CHANGE,this,"_onViewChange");this._routing=new NwNavRoute("/","Home")},_setupNavRouting:function(){this.nav.setRouting(this._routing)},_onViewChange:function(a){},init:function(){var a=this._s("NwTabbedApp","init",arguments);this._setupNavRouting();return a},load:function(a){if(isString(a)||(isObjective(a)&&a.is("OjUrl"))){this.nav.loadPath(a)}else{this.nav.loadRoute(a)}}});OJ.extendClass(OjStack,"NwCollectionStack",{_p_:{collection:null,itemRenderer:OjItemRenderer},_c:function(){this._s("NwCollectionStack","_c",arguments);var a=arguments.length;if(a){if(a>1){this.setItemRenderer(arguments[1])}this.setCollection(arguments[0])}},_d:function(){this._items=null;return this._s("NwCollectionStack","_d",arguments)},_createView:function(a){return new this._itemRenderer(this,a)},_onDataAdd:function(a){},_onDataMove:function(a){},_onDataRemove:function(a){},_onDataReplace:function(a){this.container.getChildAt(a.getIndex()).setData(this._active=a.getItem())},addElm:function(a){throw new Error("Data Driven Component. Therefore addElm() is not permitted.")},addElmAt:function(b,a){throw new Error("Data Driven Component. Therefore addElmAt() is not permitted.")},getElmAt:function(a){var b,c=this._s("NwCollectionStack","getElmAt",arguments);if(!c&&this._collection&&(b=this._collection.getItemAt(a))){this._items.setItemAt(c=this._createView(b),a)}return c},moveElm:function(){throw new Error("Data Driven Component. Therefore moveElm() is not permitted.")},removeAllElms:function(){throw new Error("Data Driven Component. Therefore removeAllElms() is not permitted.")},removeElm:function(a){throw new Error("Data Driven Component. Therefore removeElm() is not permitted.")},removeElmAt:function(a){throw new Error("Data Driven Component. Therefore removeElmAt() is not permitted.")},replaceElm:function(b,a){throw new Error("Data Driven Component. Therefore replaceElm() is not permitted.")},replaceElmAt:function(b,a){throw new Error("Data Driven Component. Therefore replaceElmAt() is not permitted.")},setCollection:function(b){this._items.removeAllItems();if(this._collection){this._collection.removeEventListener(OjCollectionEvent.ITEM_ADD,this,"_onDataAdd");this._collection.removeEventListener(OjCollectionEvent.ITEM_MOVE,this,"_onDataMove");this._collection.removeEventListener(OjCollectionEvent.ITEM_REMOVE,this,"_onDataRemove");this._collection.removeEventListener(OjCollectionEvent.ITEM_REPLACE,this,"_onDataReplace")}if(this._collection=OjCollection.collection(b)){this._collection.addEventListener(OjCollectionEvent.ITEM_ADD,this,"_onDataAdd");this._collection.addEventListener(OjCollectionEvent.ITEM_MOVE,this,"_onDataMove");this._collection.addEventListener(OjCollectionEvent.ITEM_REMOVE,this,"_onDataRemove");this._collection.addEventListener(OjCollectionEvent.ITEM_REPLACE,this,"_onDataReplace");var a=this._collection.numItems();for(;a--;){this._items.addItem(null)}}this.redraw()},setItemRenderer:function(a){this._itemRenderer=isString(a)?window[a]:a}});OJ.extendClass(OjComponent,"NwMarquee",{_p_:{buttonMode:null,interval:0,itemRenderer:null,nextButtonIcon:null,nextButtonLabel:"Next >",prevButtonIcon:null,prevButtonLabel:"< Prev"},_t:"<div><div var=prerender></div><stack var=container></stack></div>",_timer:null,nextBtn:null,prevBtn:null,_c:function(){this._s("NwMarquee","_c",[]);var a=arguments,b=a.length;if(b){if(b>1){if(b>2){this.setItemRenderer(a[2])}this.setTransition(a[1])}this.setItems(a[0])}this.container.setAllowLooping(true);this.container.addEventListener(OjMouseEvent.OVER,this,"_onMouseOver");this.container.addEventListener(OjMouseEvent.OUT,this,"_onMouseOut");this.container.addEventListener(OjStackEvent.CHANGE_COMPLETE,this,"_onChange");this._timer=new OjTimer(this._interval*1000,0);this._timer.addEventListener(OjTimer.TICK,this,"_onTimerTick");this.setButtonMode(NwMarquee.HIDE_BUTTONS)},_d:function(){this._u("_timer");return this._s("NwMarquee","_d",arguments)},_setIsDisplayed:function(a){if(this._is_displayed==a){return}this._s("NwMarquee","_setIsDisplayed",arguments);if(this._is_displayed){if(this._timer.isPaused()){this.start()}this.redraw()}else{if(this._timer.isRunning()){this._timer.pause()}}},_redrawButtons:function(){if(this._is_displayed){if(this.prevBtn){this.prevBtn.setIsDisabled(!this._allowLooping&&this._current_index<=0)}if(this.nextBtn){this.nextBtn.setIsDisabled(!this._allowLooping&&this._current_index>=this.numElms()-1)}return true}return false},_onChange:function(b){var a=this.container,c=b.getIndex();var d=this.prerender;d.removeAllChildren();d.addChild(a.renderItem(a.getElmAt(c-1)));d.addChild(a.renderItem(a.getElmAt(c+1)))},_onTimerTick:function(a){this.next()},_onMouseOut:function(a){if(this._timer.getState()==OjTimer.PAUSED){this.start()}},_onMouseOver:function(a){if(this._timer.isRunning()){this._timer.pause()}},_onNextClick:function(a){this.next()},_onPrevClick:function(a){this.prev()},next:function(){if(this._timer.isRunning()){this._timer.restart()}this.container.next()},prev:function(){if(this._timer.isRunning()){this._timer.restart()}this.container.prev()},start:function(){if(this._interval){this._timer.start()}},stop:function(){this._timer.stop()},getAllowLooping:function(){return this.container.getAllowLooping()},setAllowLooping:function(a){this.container.setAllowLooping(a);this._redrawButtons()},getAlwaysTrans:function(){return this.container.getAlwaysTrans()},setAlwaysTrans:function(a){return this.container.setAlwaysTrans(a)},setButtonMode:function(a){if(this._buttonMode==a){return}if(this._buttonMode){this.removeCss([this._buttonMode])}this.addCss([this._buttonMode=a]);if(this._buttonMode==this.$.HIDE_BUTTONS){this.removeChild(this.prevBtn);this.removeChild(this.nextBtn)}else{if(!this.prevBtn){this.prevBtn=new OjButton(this._prevButtonLabel,this._prevButtonIcon);this.prevBtn.addCss(["prevBtn"]);this.prevBtn.addEventListener(OjMouseEvent.CLICK,this,"_onPrevClick")}this.addChild(this.prevBtn);if(!this.nextBtn){this.nextBtn=new OjButton(this._nextButtonLabel,this._nextButtonIcon);this.nextBtn.addCss(["nextBtn"]);this.nextBtn.addEventListener(OjMouseEvent.CLICK,this,"_onNextClick")}this.addChild(this.nextBtn)}},setInterval:function(a){this._interval=a;this._timer.setDuration(a*1000)},setIsDisabled:function(a){if(this._isDisabled==a){return}this._s("NwCollectionStack","setIsDisabled",arguments);if(this._isDisabled&&this._timer.isRunning()){this._timer.pause()}else{if(!this._isDisabled&&this._timer.isPaused()){this.start()}}},getItemRenderer:function(){return this.container.getItemRenderer()},setItemRenderer:function(a){this.container.setItemRenderer(a)},getItems:function(){return this.container.getItems()},setItems:function(a){this.container.setItems(a)},setNextButtonIcon:function(a){if(this._nextButtonIcon==a){return}this._nextButtonIcon=a;if(this.nextBtn){this.nextBtn.setIcon(a)}},setNextButtonLabel:function(a){if(this._nextButtonLabel==a){return}this._nextButtonLabel=a;if(this.nextBtn){this.nextBtn.setLabel(a)}},setPrevButtonIcon:function(a){if(this._prevButtonIcon==a){return}this._prevButtonIcon=a;if(this.prevBtn){this.prevBtn.setIcon(a)}},setPrevButtonLabel:function(a){if(this._prevButtonLabel==a){return}this._prevButtonLabel=a;if(this.prevBtn){this.prevBtn.setLabel(a)}},getTransition:function(){return this.container.getTransition()},setTransition:function(a){return this.container.setTransition(a)}},{HIDE_BUTTONS:"hide-buttons",HOVER_BUTTONS:"hover-buttons",SHOW_BUTTONS:"show-buttons"});OJ.extendClass(OjView,"NwView",{_c:function(){this._s("NwView","_c",[]);if(arguments.length){this.setData(arguments[0])}}});OJ.extendClass(NwMarquee,"NwCarousel",{_p_:{viewSize:50},_allow_loop:false,_current_pos:0,_index:null,_offset:0,_tween:null,_view_offset:0,_visable_size:0,_c:function(){this._index={};this._s("NwCarousel","_c",arguments)},_redrawPosition:function(g){if(!this._collection){return}var d,e,k,j,a,h,c=this._offset+this._view_offset,f=this._collection.numItems(),b=this.container.getChildren();if(g<0){a=Math.ceil((g-c)/this._viewSize);h=Math.ceil((g+c)/this._viewSize)}else{a=Math.signedCeil((g-c)/this._viewSize);h=Math.signedCeil((g+c)/this._viewSize)}for(d=a;d<h;d++){if(d<0){if(this._allow_loop){k=d*this._viewSize;e=(f-1)+(d%f)}else{e=0;k=0}}else{if(d<f){k=(e=d)*this._viewSize}else{if(this._allow_loop){e=d%f}else{e=f-1}k=d*this._viewSize}}if(j=this.getElmAt(e)){j.setX(k+this._offset-this._view_offset-g);j.setWidth(this._viewSize);if(this.container.hasChild(j)){b.splice(b.indexOf(j),1)}else{j.addEventListener(OjMouseEvent.CLICK,this,"_onViewClick");this.container.addChild(j)}this._index[j.id()]=d}}d=b.length;while(d--){b[d].removeEventListener(OjMouseEvent.CLICK,this,"_onViewClick");this.container.removeChild(b[d])}this._current_pos=g},redraw:function(){if(this._s("NwCarousel","redraw",arguments)){this._visable_size=this.container.getWidth();this._offset=this._visable_size/2;this._view_offset=this._viewSize/2;this._allow_loop=this._visable_size<this.numElms()*this._viewSize;this._redrawPosition(this._current_pos);return true}return false},_onTweenTick:function(a){this._redrawPosition(a.getValue())},_onViewClick:function(a){this.setActiveIndex(this._index[a.getCurrentTarget().id()])},setActiveIndex:function(e){var a=null,b=null,d=null;if(this._activeIndex==e&&this._active){return}if(!this._active){this._activeIndex=e;this._active=this.getElmAt(e);this._redrawPosition(e*this._viewSize);return}var c=this.numElms();this._tween=new OjTween(this._current_pos,(this._current_index=e)*this._viewSize,300,OjEasing.OUT);this._tween.addEventListener(OjTweenEvent.TICK,this,"_onTweenTick");e=e%c;if(e<0){e=c+e}this._activeIndex=e;if(this._active=this.getElmAt(e)){this._tween.start()}else{this._activeIndex=-1}}});OJ.extendComponent(OjComponent,"NwScrollPane",OJ.implementInterface(OjICollection,{_p_:{items:null},_c:function(){this._s("NwScrollPane","_c",[]);this._elm_funcs={addElm:"addItem",addElmAt:"addItemAt",getElmAt:"getItemAt",getElms:"getItems",hasElm:"hasItem",indexOfElm:"indexOfItem",moveElm:"moveItem",numElms:"numItems",removeAllElms:"removeAllItems",removeElm:"removeItem",removeElmAt:"removeItemAt",replaceElm:"replaceItem",replaceElmAt:"replaceItemAt"};this._dims=[];this.addEventListener(OjScrollEvent.SCROLL,this,"_onScroll")},_recalculateLayout:function(d){var j=this.numElms(),m=this.getInnerWidth(),e=this.getInnerHeight(),l=0,k=0,c,g,f,b,a;if(!m||!e){return}for(;d<j;d++){if(d>0){c=this._dims[d-1];l=c.right;k=c.bottom}g=this.getElmAt(d);f=g.getWidth();b=g.getHeight();if(f+l>m){l=0;a=d-1;for(;a--;){if(this._dims[a].left==0){k=this._dims[a].bottom}}}this._dims[d]=OJ.makeRect(l,k,f,b)}},_onDomScrollEvent:function(a){var b=OjElement.byId(this.ojProxy);if(b&&b._processEvent(a)){b._onEvent(OjScrollEvent.convertDomEvent(a))}},_onScroll:function(a){},addEventListener:function(a){this._s("NwScrollPane","addEventListener",arguments);if(a==OjScrollEvent.SCROLL){this._proxy.onscroll=this._onDomScrollEvent}},redraw:function(){if(this._s("NwScrollPane","redraw",arguments)){this._recalculateLayout(0);return true}return false},_prepareItems:function(){if(this._items){return}var a=(this._items=new OjCollection());a.addEventListener(OjCollectionEvent.ITEM_ADD,this,"_onItemChange");a.addEventListener(OjCollectionEvent.ITEM_MOVE,this,"_onItemChange");a.addEventListener(OjCollectionEvent.ITEM_REMOVE,this,"_onItemChange");a.addEventListener(OjCollectionEvent.ITEM_REPLACE,this,"_onItemChange");return a},_onItemChange:function(a){OJ.render(this.getElmAt(a.getIndex()));this._recalculateLayout(a.getIndex())}}),{_TAGS:["scrollpane"]});OJ.extendClass(OjEvent,"NwDataEvent",{_g_p_:{data:null,oldData:null},_c:function(c){var b,a=b=false,d=arguments.length;if(d>1){this._data=arguments[1];if(d>2){this._oldData=arguments[2];if(d>3){a=arguments[3];if(d>4){b=arguments[4]}}}}this._s("NwDataEvent","_c",[c,a,b])}},{CHANGE:"onDataChange",DELETE:"onDataDelete",LOAD:"onDataLoad",SAVE:"onDataSave"});OJ.extendClass(OjErrorEvent,"NwDataErrorEvent",{_g_p_:{data:null},_c:function(b){var a=Array.array(arguments),c=a.length;if(c>1){this._data=a[1];a.splice(1,1)}this._s("NwDataErrorEvent","_c",a)}},{DELETE:"onDataDeleteError",LOAD:"onDataLoadError",SAVE:"onDataSaveError"});OJ.extendClass(OjObject,"NwProperty",{_p_:{"default":null,defaultValue:null,label:null,max:1,min:0,readCallback:null,readPermission:"*",required:false,writeCallback:null,writePermission:"*"},_g_p_:{name:null},_c:function(){this._s("NwDataProperty","_c",[]);if(arguments.length){var a,c,b=arguments[0];for(a in b){c="set"+a.ucFirst();if(isFunction(this[c])){this[c](b[a])}}}},_exportValue:function(b,a,c){return b},_formatter:function(e,f){var d=arguments.length,a=d>2?arguments[2]:null,h=d>3?arguments[3]:NwData.DEFAULT;if(this._max!=1){var g=isArray(a)?a.length:0;if(!isArray(f)){return[e.call(this,f,g?a[0]:null,h)]}var c=[];for(var b=f.length;b--;){c.unshift(e.call(this,f[b],b<g?a[b]:null,h))}return c}return e.call(this,f,a,h)},_importValue:function(b,a,c){return b},_valueIsValid:function(a){return true},exportValue:function(a,b){return this._formatter(this._exportValue,a,null,b)},importValue:function(b,a,c){return this._formatter(this._importValue,b,a,c)},makeInput:function(){var a;if(arguments.length&&isObjective(a=arguments[0])){}else{a=new OjTextInput(this._name,this._label,this._defaultValue)}a.setDefault(this._default);a.setRequired(this._required);return a},setup:function(d,c,b){this._name=c;var a="get"+b,e="set"+b;if(!d[a]){d[a]=function(){return this.$.getProperty(c).value(this,c)}}if(!d[e]){d[e]=function(f){this.$.getProperty(c).value(this,c,f)}}},userCanRead:function(a,b){return this._readPermission&&a.hasPermission(this._readPermission)&&(!this._readCallback||this._readCallback(a,b,this))},userCanWrite:function(a,b){return this._writePermission&&a.hasPermission(this._writePermission)&&(!this._writeCallback||this._writeCallback(a,b,this))},value:function(c,b){var a=arguments;return c.property.apply(c,Array.array(a).slice(1))},valueIsValid:function(c){if(this._max==1){return this._valueIsValid(c)&&(!this._min||isSet(c))}if(!isArray(c)){return false}var b=0;for(var a=c.length;a--;){if(!this._valueIsValid(c[a])){return false}b++}return !this._min||!(b<this._min)},setMax:function(a){this._max=Math.max(a,0)},setMin:function(a){this._min=Math.max(a,0)}});OjStyleElement.registerComponentTag("datainput",function(b){var a=b.getAttribute("source").split(".");b.removeAttribute("source");return OJ.stringToClass(a[0]).DEFINITION[a[1]].makeInput(b)});OjStyleElement.registerComponentTag("datainputs",function(e){var d=e.getAttribute("source"),a=OjStyleElement(),c=OJ.stringToClass(d).DEFINITION,b;e.removeAttribute("source");for(b in c){a.addChild(c[b].makeInput())}return a});OJ.extendClass(NwProperty,"NwUuidProperty",{});OJ.extendClass(OjActionable,"NwData",{_post_compile_:function(c){NwData.registerDataType(this.$.TYPE,this._class_name);var d=this.$.DEFINITION,e=this.$.EXPORT_MAP,a=(this.$.IMPORT_MAP=Object.clone(this.$.IMPORT_MAP)),b;for(b in d){d[b].setup(this,b,b.ucFirst())}for(b in e){a[e[b]]=b}this.$.CACHE={}},_data:null,_dirty:null,_keyword_cache:null,_loader:null,_is_loaded:false,_c:function(){this._s("NwData","_c",[]);this._data={};this._dirty=[];this._keyword_cache={};var a=arguments.length;if(a){this._prevent_dispatch=true;this.importData(arguments[0],a>1?arguments[1]:NwData.DEFAULT);this._prevent_dispatch=false}},_addToDirty:function(a){if(this._dirty&&this._dirty.indexOf(a)==-1){this._dirty.push(a)}},_exportValue:function(b,a){if(this.$.hasProperty(b)){return this.$.DEFINITION[b].exportValue(this._data[b],a)}return this._data[b]},_getDeleteRequest:function(d){var a=Array.prototype.splice.call(arguments,0);if(a.length<2){var c={};c[this.$.PRIMARY_KEY]=this.primarKey();a.push(c)}var b=this._getRequest(this._translateDeleteParam,a);b.getRequest().setType(OjUrlRequest.POST);return b},_getLoadRequest:function(c){var a=Array.prototype.splice.call(arguments,0);if(a.length<2){var b={};b[this.$.PRIMARY_KEY]=this.primaryKey();a.push(b)}return this._getRequest(this._translateLoadParam,a)},_getRequest:function(a,b){if(b.length>1){var c,e,f,g,d={};for(c in b[1]){e=a.call(this,c);if(e){f=this._exportValue(c,NwData.API);if(isObject(f)&&(g=this.$.getProperty(c)).getFlatten()){for(c in f){e=a.call(this,g.getNamespace()+"."+c);if(e){d[e]=f[c]}}}else{d[e]=f}}}b[1]=d}return AppManager.apiRequest.apply(AppManager,b)},_getSaveRequest:function(){var a=Array.array(arguments);if(a.length<2){if(this.isNew()){a.push(Object.clone(this._data))}else{var b=this._dirty.length,d={};d[this.$.PRIMARY_KEY]=this.primaryKey();for(;b--;){d[this._dirty[b]]=this._data[this._dirty[b]]}a.push(d)}}var c=this._getRequest(this._translateSaveParam,a);c.getRequest().setMethod(OjUrlRequest.POST);return c},_importValue:function(f,d,e){if(this.$.hasProperty(f)){var b="set"+f.ucFirst();d=this.$.DEFINITION[f].importValue(d,this.property(f),e);if(b!="setnull"&&this[b]){this[b](d)}else{this.property(f,d)}if(e==NwData.API){var a=this._dirty.indexOf(f);if(a!=-1){this._dirty.splice(a,1)}}return}var a=f.indexOf(".");if(a>0){var c={};c[f.substr(a+1)]=d;this._importValue(f.substr(0,a),c,e)}},_processDeleteData:function(a){},_processLoadData:function(a){this.importData(a,NwData.API)},_processSaveData:function(a){this.importData(a,NwData.API)},_resetLoader:function(){if(this._loader){this._loader.cancel();this._loader=null}},_translateDeleteParam:function(b){var a=this.$.EXPORT_MAP;return a[b]?a[b]:b},_translateLoadParam:function(b){var a=this.$.EXPORT_MAP;return a[b]?a[b]:b},_translateSaveParam:function(b){var a=this.$.EXPORT_MAP;return a[b]?a[b]:b},_onDelete:function(a){this._is_loaded=false;this.primaryKey(null);this._processDeleteData(this._loader.getData());this._u("_loader");this.dispatchEvent(new NwDataEvent(NwDataEvent.DELETE));this.$.dispatchEvent(new NwDataEvent(NwDataEvent.DELETE,this))},_onDeleteFail:function(a){this._u("_loader");this.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.DELETE));this.$.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.DELETE,this))},_onLoad:function(a){this._is_loaded=true;this._processLoadData(this._loader.getData());this._u("_loader");this.dispatchEvent(new NwDataEvent(NwDataEvent.LOAD));this.$.dispatchEvent(new NwDataEvent(NwDataEvent.LOAD,this))},_onLoadFail:function(a){this._u("_loader");this.dispatchEvent(new NwDataEvent(NwDataErrorEvent.LOAD));this.$.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.LOAD,this))},_onSave:function(a){if(a){var e=a.getTarget(),b=e.getData();if(e.is("OjRpc")){if(!b||b.error){return this._onSaveFail(a)}b=b.result}this._processSaveData(b);var c,d,f=e.getRequest().getData(),g=this.$.EXPORT_MAP;for(d in f){c=this._dirty.indexOf(g[d]);if(c!=-1){this._dirty.splice(c,1)}}if(this._loader==e){this._u("_loader")}}this.dispatchEvent(new NwDataEvent(NwDataEvent.SAVE,this));this.$.dispatchEvent(new NwDataEvent(NwDataEvent.SAVE,this))},_onSaveFail:function(a){var e,d;if(a){var c=this._loader,b=c.getData();if(c.is("OjRpc")&&b){e=b.error.code;d=b.error.message}this._u("_loader")}this.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.SAVE,this,d,e));this.$.dispatchEvent(new NwDataErrorEvent(NwDataErrorEvent.SAVE,this,d,e))},clone:function(){var a=this._s("NwData","clone",[]);a.importData(this._data,NwData.CLONE);return a},"delete":function(){this._resetLoader();this._loader=this._getDeleteRequest();this._loader.addEventListener(OjEvent.COMPLETE,this,"_onDelete");this._loader.addEventListener(OjEvent.FAIL,this,"_onDeleteFail");this._loader.load()},exportData:function(){var a,b,e,h,g,f=arguments.length?arguments[0]:NwData.DEFAULT,d=f==NwData.DEFAULT,c=this.$.EXPORT_MAP;if(d){e=this._s("NwData","exportData",arguments)}else{e={};if(!this.isNew()){e[this.$.PRIMARY_KEY]=this.primaryKey()}}for(a in this._data){if(d||this._dirty.indexOf(a)!=-1){g=this._exportValue(a,f);if(isObject(g)&&(h=this.$.getProperty(a)).getFlatten()){for(a in g){if(a=="_class_name"){continue}b=h.getNamespace()+"."+a;e[c[b]?c[b]:b]=g[a]}}else{e[c[a]?c[a]:a]=g}}}return e},importData:function(c){var a,e=arguments.length>1?arguments[1]:NwData.DEFAULT,d=this.$.IMPORT_MAP,b=this.$.PRIMARY_KEY;for(a in c){if(e==NwData.CLONE&&a==b){continue}this._importValue(d[a]?d[a]:a,c[a],e)}},isDirty:function(){return this._dirty.length>0},isLoaded:function(){return this._is_loaded},isNew:function(){return isEmpty(this.primaryKey())},primaryKey:function(){if(arguments.length){this.property(this.$.PRIMARY_KEY,arguments[0])}return this._data[this.$.PRIMARY_KEY]},keywordScore:function(a){var c=[],e=0;if(isArray(a)){c=a}else{c.push(a)}var b,d=c.length;while(d-->0){for(b in this._keyword_cache){if(this._keyword_cache[b]){e+=this._keyword_cache[b].count(c[d].toLowerCase())/(d+1)}}}return e},load:function(){var a=arguments,c=a.length,b=c?a[0]:false;if(this._is_loaded&&!b){return}this._resetLoader();this._is_loaded=false;this._loader=this._getLoadRequest();this._loader.addEventListener(OjEvent.COMPLETE,this,"_onLoad");this._loader.addEventListener(OjEvent.FAIL,this,"_onLoadFail");this._loader.load()},property:function(f){var b=arguments,c=this._data[f];if(b.length>1){var e=b[1];if(c!=e){this._addToDirty(f);var a=new NwDataEvent(NwDataEvent.CHANGE,e,c);this._data[f]=e;var d=this.$.DEFINITION;if(d&&d[f]&&d[f].is("OjTextProperty")){this._keyword_cache[f]=value?value.toLowerCase():null}this.dispatchEvent(a)}}return c},save:function(){if(!this.isNew()&&isEmpty(this._dirty)){this._onSave(null);return}this._resetLoader();this._loader=this._getSaveRequest();this._loader.addEventListener(OjEvent.COMPLETE,this,"_onSave");this._loader.addEventListener(OjEvent.FAIL,this,"_onSaveFail");this._loader.load()},title:function(){return null},getId:function(){return this._data.id},setId:function(a){var b=this.getId();if(b){delete this.$.CACHE[b]}this.property("id",a);if(a){this.$.CACHE[a]=this}}},{API:"api",CLONE:"clone",DEFAULT:"default",CACHE:{},DEFINITION:{id:new NwUuidProperty()},EXPORT_MAP:{},IMPORT_MAP:{},PRIMARY_KEY:"id",TYPE:"Data",TYPES:{},_callApi:function(a,b,e,c,d){return this._callApiWithRequest(AppManager.apiRequest(a,b,e),c,d)},_callApiWithRequest:function(a,b,c){a.addEventListener(OjEvent.COMPLETE,this,b);a.addEventListener(OjEvent.FAIL,this,c);a.load();return a},_onApiFail:function(a,c,e){var b=arguments,d=b.length;if(a){a=OJ.destroy(a)}this.dispatchEvent(new NwDataErrorEvent(c,e,d>3?b[3]:null,d>4?b[4]:null))},_onApiLoad:function(a,e,g){var b=arguments,f=b.length,c=f>3?b[3]:null;if(a){var h=this.importData(a.getTarget().getData(),NwData.API);if(c){this[g][c]=h}else{this[g]=h}a=OJ.destroy(a)}this.dispatchEvent(new NwDataEvent(e,c?this[g][c]:this[g],f>4?b[4]:null))},addEventListener:function(b,a,c){EventManager.addEventListener(this,b,a,c)},dispatchEvent:function(a){if(this._prevent_dispatch){return}EventManager.dispatchEvent(this,a)},get:function(d){if(!this.CACHE[d]){var b=this;var a=new b();a.setId(d)}return this.CACHE[d]},getProperty:function(a){return this.DEFINITION[a]},hasEventListener:function(a){return EventManager.hasEventListener(this,a)},hasProperty:function(a){return !isUndefined(this.DEFINITION[a])},id:function(){if(!this.CLASS_NAME){this.CLASS_NAME=OJ.classToString(this)}return this.CLASS_NAME},importData:function(d){var a=arguments,f=a.length>1?a[1]:NwData.DEFAULT;if(isArray(d)){var b=d.length;while(b-->0){d[b]=this.importData(d[b],f)}return d}if(isObject(d)){var h=d._class_name?OJ.stringToClass(d._class_name):this;if(h){var e,g=d[this.PRIMARY_KEY];if(g&&h.CACHE[g]){e=h.CACHE[g]}else{e=new h()}e.importData(d,f);return e}}return null},load:function(b){if(!b){return null}var a=this.get(b);if(a.isLoaded()&&(arguments.length==1||!arguments[1])){this.dispatchEvent(new NwDataEvent(NwDataEvent.LOAD,a))}else{a.load()}return a},registerDataType:function(a,b){if(!NwData.TYPES[a]){NwData.TYPES[a]=b}},removeAllListeners:function(){return EventManager.removeAllListeners(this)},removeEventListener:function(b,a,c){EventManager.removeEventListener(this,b,a,c)},typeToClass:function(a){if(NwData.TYPES[a]){return OJ.stringToClass(NwData.TYPES[a])}return null},uuid:function(){return uuid.v4()}});OJ.extendClass(OjForm,"NwDataForm",{});OJ.extendClass(OjItemRenderer,"NwDataItemRenderer",{_onDataChange:function(a){this._redrawData()},setData:function(a){if(this._data){this._data.removeEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}this._s("NwDataItemRenderer","setData",arguments);if(this._data){this._data.addEventListener(NwDataEvent.CHANGE,this,"_onDataChange")}}});OJ.extendClass(OjListItem,"NwDataListItem",{_redrawData:function(){this.content.setText(this._data.title())}});OJ.extendClass(OjView,"NwDataView",{});OJ.extendClass(OjActionable,"NwLinkData",{_active:false,_url:null,_title:null,_icon:null,_c:function(){this._s("NwLinkData","_c",[]);var a=arguments.length;if(a){this.setTitle(arguments[0]);if(a>1){this.setUrl(arguments[1]);if(a>2){this.setIcon(arguments[2])}}}},getIcon:function(){return this._icon},setIcon:function(a){if(this._icon!=a){this._icon=a;this.dispatchEvent(new OjEvent(OjEvent.CHANGE))}},getUrl:function(){return this._calculated_url},setUrl:function(a){if(this._url!=a){this._url=a;this._recalculatePath()}},getTitle:function(){return this._title},setTitle:function(a){if(this._title!=a){this._title=a;this.dispatchEvent(new OjEvent(OjEvent.CHANGE))}}});OJ.extendClass(NwProperty,"NwDateProperty",{_max_date:null,_min_date:null,_processValue:function(a){if(!isDate(a)){a=new Date(a)}if(this._max_date&&a>this._max_date){a=new Date(this._max_date.getTime())}if(this._min_date&&a<this._min_date){a=new Date(this._min_date.getTime())}return a},_valueIsValid:function(a){return isDate(a)&&(!this._min_date||a>=this._min_date)&&(!this._max_date||a>=this._max_date)},getMaxLength:function(){return this._max_date},setMaxLength:function(a){this._max_date=!this._min_date||a>this._min_date?a:this._min_date},getMinDate:function(){return this._min_date},setMinDate:function(a){this._min_date=!this._max_date||a<this._max_date?a:this._max_date}});OJ.extendClass(NwProperty,"NwNumberProperty",{_max_value:null,_min_value:null,_rounding:"round",_step:0,_type:"float",_processValue:function(a){if(!isNumber(a)){a=parseFloat(a)}if(isSet(this._min_value)){a=Math.max(this._min_value,a)}if(isSet(this._max_value)){a=Math.min(this._max_value,a)}if(this._step){}if(this._type==NwNumberProperty.INT){a=this._round(a)}return a},_round:function(a){if(this._rounding==NwNumberProperty.CEIL){return Math.ceil(a)}if(this._rounding==NwNumberProperty.FLOOR){return Math.floor(a)}return Math.round(a)},_valueIsValid:function(a){if(!isNumber(a)||(this._type==NwNumberProperty.INT&&!isInt(a))||(isSet(this._min_value)&&a<this._min_value)||(isSet(this._max_value)&&a>this._max_value)){return false}return true},getType:function(){return this._type},setType:function(a){this._type=a},getMaxValue:function(){return this._max_value},setMaxValue:function(a){this._max_value=a},getMinValue:function(){return this._min_value},setMinValue:function(a){this._min_value=a}},{FLOAT:"float",INT:"int",CEIL:"ceil",FLOOR:"floor",ROUND:"round"});OJ.extendClass(NwData,"NwRailsData",{_getDeleteRequest:function(b){var a=this._s("NwRailsData","_getDeleteRequest",[b,arguments.length>1?arguments[1]:null]);a.getRequest().setContentType(OjUrlRequest.QUERY_STRING);return a},_getLoadRequest:function(b){var a=this._s("NwRailsData","_getLoadRequest",[b,arguments.length>1?arguments[1]:null]);a.getRequest().setContentType(OjUrlRequest.QUERY_STRING);return a},_getSaveRequest:function(b){var a=this._s("NwRailsData","_getSaveRequest",arguments);a.getRequest().setContentType(OjUrlRequest.QUERY_STRING);return a},_translateSaveParam:function(a){if(a=="id"||a=="created"||a=="modified"||a=="_class_name"||a=="_class_path"){return null}return this._s("NwRailsData","_translateSaveParam",arguments)}},{DEFINITION:{id:new NwNumberProperty(),created:new NwDateProperty(),modified:new NwDateProperty()},EXPORT_MAP:{created:"created_at",modified:"updated_at"},TYPE:"RailsData","import":function(d){if(isArray(d)){var b=d.length;while(b-->0){d[b]=this.importData(d[b])}return d}if(isObject(d)){var a=Object.keys(d);var b=a.length;var g=this;if(b==1){g=NwData.typeToClass(a[0]);d=d[a[0]]}if(g){var e,f=d[g.PRIMARY_KEY];if(f&&g.CACHE[f]){e=g.CACHE[f]}else{e=new g()}e.importData(d);return e}}return null}});OJ.extendClass(NwProperty,"NwTextProperty",{_p_:{minLength:0,maxLength:255},_processValue:function(a){if(!isString(a)){a=String(a)}if(this._maxLength&&a.length>this._maxLength){a=a.substr(0,this._maxLength)}if(this._minLength&&a.length<this._minLength){a=null}return a},_valueIsValid:function(a){if(!this._minLength&&isNull(a)){return true}a=String(a);return(!this._minLength||a.length>=this._minLength)&&(!this._maxLength||a.length<=this._maxLength)},makeInput:function(){var a=this._s("NwTextProperty","makeInput",arguments);a.setMinLength(this._minLength);a.setMaxLength(this._maxLength);return a},setMaxLength:function(a){this._maxLength=Math.max(a,0)},setMinLength:function(a){this._minLength=Math.max(a,0)}});window.NwIUser={hasPermission:function(c){if(c=="*"||this.isAdmin()){return true}var b=this.getRoles();if(b){for(var a=b.length;a;a--){if(AppManager.roleHasPermission(b[a],c)){return true}}}return false},isAdmin:function(){return AppManager.userIsAdmin(this)}};OJ.extendClass(NwData,"NwUser",NwIUser,{DEFINITION:{id:new NwNumberProperty(),name:new NwTextProperty(),roles:new NwTextProperty()},TYPE:"User"});OJ.extendClass(NwRailsData,"NwRailsUser",OJ.implementInterface(NwIUser,{}),{DEFINITION:OJ.merge({},NwUser.DEFINITION,NwRailsData.DEFINITION),TYPE:"User"});OJ.extendClass(NwProperty,"NwBooleanProperty",{_exportValue:function(b,a,c){return b?1:0},_processValue:function(b,a,c){return isTrue(b)}});OJ.extendClass(NwTextProperty,"NwEmailProperty",{_p_:{maxLength:254,minLength:3},makeInput:function(b){var a=new OjEmailInput(this._name,this._label,this._defaultValue);a.setDefault(this._default);a.setRequired(this._required);return a},setMaxLength:function(a){throw new Error("Cannot set the max length of an email. This is a fixed value.")},setMinLength:function(a){throw new Error("Cannot set the min length of an email. This is a fixed value.")}});OJ.extendClass(NwProperty,"NwFileProperty",{});OJ.extendClass(NwFileProperty,"NwMediaProperty",{_p_:{formats:null,missing:null},_c:function(){this._formats=[];this._s("NwMediaProperty","_c",arguments)},_setupFormatFunc:function(f,d,c,e){var b=e.ucFirst(),a="get"+c+b,g="set"+c+b;if(!f[a]){f[a]=function(){return this.$.getProperty(d).formatValue(this,d,e)}}if(!f[g]){f[g]=function(h){this.$.getProperty(d).formatValue(this,d,e,h)}}},formatValue:function(e,b,d){var a=arguments,f=a.length>3,c=e.property(b);if(f){if(!c){e["set"+b.ucFirst()](c={})}return c[d]=a[3]}if(!c){return null}c=c[d];if(!c&&this._missing){if(isString(this._missing)){return this._missing}c=this._missing[d]}return c},setup:function(d,b,a){this._s("NwMediaProperty","setup",arguments);var c=this._formats.length;for(;c--;){this._setupFormatFunc(d,b,a,this._formats[c])}}});OJ.extendClass(NwProperty,"NwObjectProperty",{_p_:{flatten:false,namespace:null}});OJ.extendClass(NwObjectProperty,"NwReferenceProperty",{_p_:{"class":NwData,allowNesting:false},_c:function(a){this._s("NwReferenceProperty","_c",arguments.length>1?[arguments[1]]:[]);this.setClass(a)},_exportSubValue:function(b,a,c){if(b&&isObjective(b)){return(this._allowNesting||this._flatten)?b.exportData(c):b.primaryKey()}return b},_exportValue:function(d,a,e){if(this._max==1){return this._exportSubValue(d,a,e)}var b=[],c=d?d.numItems():0;for(;c--;){b.unshift(this._exportSubValue(d.getItemAt(c),a,e))}return b},_formatter:function(b,c){var a=arguments.length;return b.call(this,c,a>2?arguments[2]:null,a>3?arguments[3]:NwData.DEFAULT)},_importSubValue:function(c,b,d){if(!c){return null}if(isObjective(c)&&c.is(this._class)){return c}if((this._allowNesting||this._flatten)&&b){if(isObject(c)){b.importData(c,d)}else{b.primaryKey(c)}return b}var a=this.getClass();return isObject(c)?a.importData(c,d):a.get(c)},_importValue:function(f,b,h){if(this._max==1){return this._importSubValue(f,b,h)}var g=b?b.numItems():0,a=g?b:new OjCollection();if(isArray(f)){var e=isArray(f)?f.length:0;e=this._max==0?e:Math.min(e,this._max);for(;e--;){if(e<g){a.setItemAt(this._importSubValue(f[e],a.getItemAt(e),h),e)}else{a.addItemAt(this._importSubValue(f[e],null,h),g)}}return a}if(isObject(f)){var d,c;for(d in f){c=parseInt(d);if(!this._max||ary.length<this._max){if(c<g){a.setItemAt(this._importSubValue(f[d],a.getItemAt(c),h),c)}else{a.addItem(this._importSubValue(f[d],null,h))}}}return a}return(this._allowNesting||this._flatten)?b:null},setup:function(c,h,i){this._name=h;if(!this._namespace){this._namespace=h}var f="get"+i,b="set"+i,g=this._namespace.ucFirst(),e,d=(this._allowNesting||this._flatten);e="on"+g+"Change";if(!c[e]){c[e]=function(j){if(d){this._addToDirty(h)}}}if(!c[f]){c[f]=function(){return this.property(h)}}if(!c[b]){c[b]=function(k){var j=this.property(h);if(j){if(j.is("NwData")){j.removeEventListener(NwDataEvent.CHANGE,this,e)}else{if(j.is("OjCollection")){j.removeEventListener(OjCollectionEvent.ITEM_ADD,this,e);j.removeEventListener(OjCollectionEvent.ITEM_MOVE,this,e);j.removeEventListener(OjCollectionEvent.ITEM_REMOVE,this,e);j.removeEventListener(OjCollectionEvent.ITEM_REPLACE,this,e)}}}this.property(h,k);if(k){if(k.is("NwData")){k.addEventListener(NwDataEvent.CHANGE,this,e)}else{if(k.is("OjCollection")){k.addEventListener(OjCollectionEvent.ITEM_ADD,this,e);k.addEventListener(OjCollectionEvent.ITEM_MOVE,this,e);k.addEventListener(OjCollectionEvent.ITEM_REMOVE,this,e);k.addEventListener(OjCollectionEvent.ITEM_REPLACE,this,e)}}}}}if(this._max==1||!this._namespace){return}var a;a="add"+g;if(!c[a]){c[a]=function(k){var j=this.property(h);if(!j){this.property(h,j=new OjCollection())}if(d){k.addEventListener(NwDataEvent.CHANGE,this,e)}this._addToDirty(h);return j.addItem(k)}}a+="At";if(!c[a]){c[a]=function(l,k){var j=this.property(h);if(!j){this.property(h,j=new OjCollection())}if(d){l.addEventListener(NwDataEvent.CHANGE,this,e)}this._addToDirty(h);return j.addItemAt(l,k)}}a="get"+g+"At";if(!c[a]){c[a]=function(k){var j=this.property(h);if(!j){return null}return j.getItemAt(k)}}a="has"+g;if(!c[a]){c[a]=function(k){var j=this.property(h);return j?j.hasItem(k):false}}a="indexOf"+g;if(!c[a]){c[a]=function(k){var j=this.property(h);return j?j.indexOfItem(k):-1}}a="num"+OJ.pluralize(g);if(!c[a]){c[a]=function(){var j=this.property(h);return j?j.numItems():0}}a="remove"+g;if(!c[a]){c[a]=function(k){var j=this.property(h);if(!j){return k}if(d){k.removeEventListener(NwDataEvent.CHANGE,this,e)}this._addToDirty(h);return j.removeItem(k)}}a+="At";if(!c[a]){c[a]=function(k){var j=this.property(h);if(!j){return null}if(d){item.removeEventListener(NwDataEvent.CHANGE,this,e)}this._addToDirty(h);return j.removeItemAt(k)}}},getClass:function(){return OJ.toClass(this._class)}});OJ.extendClass(NwTextProperty,"NwUrlProperty",{});OJ.extendClass(NwData,"NwAddress",{},{DEFINITION:OJ.merge({street:new NwTextProperty({"default":"Address",required:true}),locality:new NwTextProperty({"default":"City",required:true}),region:new NwTextProperty({"default":"State",required:true}),code:new NwTextProperty({"default":"Zip",required:true}),country:new NwTextProperty({"default":"Country"})},NwData.DEFINITION),TYPE:"Address"});OJ.extendClass(OjView,"NwNavView",{_g_p_:{route:null},_c:function(a){this._s("NwNavView","_c",[]);this._route=a;if(!this._title&&false){this._title=a.getTitle()}},_d:function(){this._route=null;return this._s("NwNavView","_d",arguments)},getBackPath:function(){var a=AppManager.getActiveRoute().getParent();return a?a.getPath():"/"}});OJ.extendManager("Facebook",OjActionable,"NwFacebook",{LOGIN:"onFbLogin",LOGIN_FAIL:"onFbLoginFail",LOGOUT:"onFbLogout",UPDATE:"onFbUpdate",ABOUT:"user_about_me",ACTIVITIES:"user_activities",ADS:"ads_management",APP_ACTIONS:function(a){return"user_actions:"+a},BIRTHDAY:"user_birthday",CHAT:"xmpp_login",CHECK_INS:"user_checkins",CHECK_INS_PUBLISH:"publish_checkins",EDUCATION:"user_education_history",EMAIL:"email",EVENT_CREATE:"create_event",EVENT_RSVP:"rsvp_event",EVENTS:"user_events",FRIEND_LISTS:"read_friendlists",FRIEND_LISTS_MANAGE:"manage_friendlists",FRIEND_REQUESTS:"read_requests",GAMES_ACTIVITY:"user_games_activity",GROUPS:"user_groups",HOMETOWN:"user_hometown",INSIGHTS:"read_insights",INTERESTS:"user_interests",LIKES:"user_likes",LOCATION:"user_location",MAILBOX:"read_mailbox",MANAGE_PAGES:"manage_pages",MUSIC_ACTIONS:"user_actions.music",NEWS_ACTIONS:"user_actions.news",NOTES:"user_notes",NOTIFICATIONS:"manage_notifications",PHOTOS:"user_photos",PRESENCE:"user_online_presence",PUBLISH_ACTIONS:"publish_actions",QUESTIONS:"user_questions",RELATIONSHIPS:"user_relationships",RELATIONSHIP_DETAILS:"user_relationship_details",RELIGION_POLITICS:"user_religion_politics",STATUS:"user_status",STREAM:"read_stream",STREAM_PUBLISH:"publish_stream",SUBSCRIPTIONS:"user_subscriptions",VIDEO_ACTIONS:"user_actions.video",VIDEOS:"user_videos",WEBSITE:"user_website",WORK_HISTORY:"user_work_history",FRIENDS_ABOUT:"friends_about_me",FRIENDS_ACTIVITIES:"friends_activities",FRIENDS_APP_ACTIONS:function(a){return"friends_actions:"+a},FRIENDS_BIRTHDAY:"friends_birthday",FRIENDS_CHECK_IN:"friends_checkins",FRIENDS_EDUCATION:"friends_education_history",FRIENDS_EVENTS:"friends_events",FRIENDS_GAMES_ACTIVITY:"friends_games_activity",FRIENDS_GROUP:"friends_groups",FRIENDS_HOMETOWN:"friends_hometown",FRIENDS_INTERESTS:"friends_interests",FRIENDS_LIKES:"friends_likes",FRIENDS_LOCATION:"friends_location",FRIENDS_MUSIC_ACTIONS:"friends_actions.music",FRIENDS_NEWS_ACTIONS:"friends_actions.news",FRIENDS_NOTES:"friends_notes",FRIENDS_PHOTOS:"friends_photos",FRIENDS_PRESENCE:"friends_online_presence",FRIENDS_QUESTIONS:"friends_questions",FRIENDS_RELATIONSHIPS:"friends_relationships",FRIENDS_RELATIONSHIP_DETAILS:"friends_relationship_details",FRIENDS_RELIGION_POLITICS:"friends_religion_politics",FRIENDS_STATUS:"friends_status",FRIENDS_SUBSCRIPTIONS:"friends_subscriptions",FRIENDS_VIDEO_ACTIONS:"friends_actions.video",FRIENDS_VIDEOS:"friends_videos",FRIENDS_WEBSITE:"friends_website",FRIENDS_WORK_HISTORY:"friends_work_history",_g_p_:{session:null},_publish_permissions:["ads_management","publish_checkins","create_event","rsvp_event","manage_friendlists","manage_pages","manage_notifications","publish_actions","publish_stream"],_app_id:null,_default_audience:null,_ready:false,_c:function(){this._s("NwFacebook","_c",arguments);this._session=CacheManager.getData("fbSession");if(!this._session){this._session={}}if(OJ.isReady()){this._onOjReady(null)}else{OJ.addEventListener(OjEvent.READY,this,"_onOjReady")}if(NW.isNative()){NW.addEventListener(this.LOGIN,this,"_onLogin");NW.addEventListener(this.LOGIN_FAIL,this,"_onLoginFail");NW.addEventListener(this.LOGOUT,this,"_onLogout");NW.addEventListener(this.UPDATE,this,"_onUpdate")}else{window.fbAsyncInit=function(){Facebook.init()}}},_d:function(){NW.removeEventListener(this.LOGIN,this,"_onLogin");NW.removeEventListener(this.LOGOUT,this,"_onLogout");NW.removeEventListener(this.UPDATE,this,"_onUpdate");return this._s("NwFacebook","_d",arguments)},_init:function(){var a=HistoryManager.get();FB.Event.subscribe("auth.statusChange",function(b){Facebook._onStatusChange(b)});FB.init({appId:this._app_id,channelUrl:"//"+a.getHost()+OJ.getRoot()+OJ.setting("assetsPath")+"/nw/social/fb_channel.php",status:true,xfbml:true})},_login:function(a){this._session=a;if(!NW.isNative()){CacheManager.setData("fbSession",this._session)}this.dispatchEvent(new OjEvent(this.LOGIN))},_loginFail:function(){this._session=null;if(!NW.isNative()){CacheManager.setData("fbSession",this._session)}this.dispatchEvent(new OjEvent(this.LOGIN_FAIL))},_logout:function(a){this._session=a;if(!NW.isNative()){CacheManager.setData("fbSession",this._session)}this.dispatchEvent(new OjEvent(this.LOGOUT))},_onLogin:function(a){this._login(a.getData())},_onLoginFail:function(a){this._loginFail()},_onLogout:function(a){this._logout(a.getData())},_onOjReady:function(a){this.removeEventListener(OjEvent.READY,this,"_onOjReady");OJ.addChildAt(new OjStyleElement('<div id="fb-root"></div>'),0);OJ.addJsFile("//connect.facebook.net/en_US/all.js",true,true)},_onStatusChange:function(a){if(a.authResponse){Facebook._login(a.authResponse)}else{Facebook._loginFail()}},_onUpdate:function(a){},init:function(){this._ready=true;if(this._app_id){this._init()}},login:function(){var a=arguments,b=a.length;if(NW.isNative()){NW.comm("fbLogin",Array.array(a)).load()}else{FB.login(Facebook._onStatusChange,{scope:b?a[0].join(","):null})}},logout:function(){if(NW.isNative()){NW.comm("fbLogout",[]).load()}else{}},makeLikeButton:function(){var a=arguments,c=a.length;var b=new OjStyleElement("<span></span>");b.dom().innerHTML='<fb:like href="'+(c?a[0]:HistoryManager.get().toString())+'" send="false" show_faces="false" data-layout="button_count"></fb:like>';if(window.FB){window.FB.XFBML.parse(b.dom())}return b},getAccessToken:function(){var b=arguments,c=b.length?b[0]:false;if(this._session&&this._session.accessToken&&!c){return this._session.accessToken}var a;if(NW.isNative()){return(a=NW.comm("fbAccessToken",[],false).load())&&a.result?this._session.accessToken=a.result:null}else{if(a=FB.getAuthResponse()){return a?this._session.accessToken=a.accessToken:null}}return null},getAppId:function(){if(this._app_id){return this._app_id}else{if(NW.isNative()){var a=NW.comm("fbAppId",[],false).load();return a&&a.result?this._app_id=a.result:null}}return null},setAppId:function(a){if(a==this._app_id){return}this._app_id=a;if(NW.isNative()){NW.comm("fbAppId",[this._app_id],true).load()}else{if(this._ready){this._init()}}},getDefaultAudience:function(){if(this._default_audience){return this._default_audience}else{if(NW.isNative()){var a=NW.comm("fbDefaultAudience",[],false).load();return a&&a.result?this._default_audience=a.result:null}}return null},setDefaultAudience:function(a){if(a==this._default_audience){return}this._default_audience=a;if(NW.isNative()){NW.comm("fbDefaultAudience",[this._default_audience],true).load()}}});OJ.extendManager("Pinterest",OjActionable,"NwPinterest",{_library_elm:null,_c:function(){this._s("NwPinterest","_c",arguments)},_reloadPins:function(){if(this._library_elm&&this._library_elm.parentNode){this._library_elm.parentNode.removeChild(this._library_elm)}this._library_elm=OJ.addJsFile("//assets.pinterest.com/js/pinit.js",true,true)},makePinItButton:function(a){var b=arguments,d=b.length,e=d<2?"":OJ.pageTitle();var c=new OjStyleElement("<span></span>");c.dom().innerHTML='<a href="//pinterest.com/pin/create/button/?url='+String.string(d>1?b[1]:HistoryManager.get()).encodeUri()+"&media="+String.string(a).encodeUri()+"&description="+String.string(d>2?b[2]:e).encodeUri()+'" data-pin-do="buttonPin" data-pin-config="none"><img src="//assets.pinterest.com/images/pidgets/pin_it_button.png" /></a>';this._reloadPins();return c}});OJ.extendManager("Twitter",OjActionable,"NwTwitter",{_p_:{user:null},_c:function(){this._s("NwTwitter","_c",arguments);OJ.addJsFile("//platform.twitter.com/widgets.js",true,true)},makeShareButton:function(){var b=arguments,d=b.length,a=d>3?b[3]:this._user;var c=new OjStyleElement("<span></span>");c.dom().innerHTML='<a href="https://twitter.com/share" class="twitter-share-button" data-url="'+String.string(d?b[0]:HistoryManager.get())+'"'+(d>1?' data-text="'+String.string(b[1])+'"':"")+(d>2&&b[2]?"":' data-count="none"')+(a?' data-via="'+a+'"':"")+(d>4?' data-related="'+String.string(b[4])+'"':"")+(d>5?' data-hashtags="'+String.string(b[5])+'"':"")+">Tweet</a>";OJ.render(c);twttr.widgets.load();return c}});