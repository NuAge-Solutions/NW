OJ.importJs("nw.layouts.NwColumnLayout");OJ.importJs("oj.components.OjCollectionComponent");OJ.importJs("oj.data.OjRect");OJ.importJs("oj.events.OjScrollEvent");OJ.importCss("nw.components.NwScrollPane");"use strict";OJ.extendComponent(OjView,"NwScrollPane",OJ.implementInterface(OjICollectionComponent,{_props_:{layout:null,allowScroll:"both"},_custom_scroll:OJ.isTouchCapable()&&(OJ.isMobile()||OJ.isTablet()),_multiplier:2,_lastScroll:0,_constructor:function(){var a=arguments;this._super("NwScrollPane","_constructor",[]);this._setup();this.addEventListener(OjScrollEvent.SCROLL,this,"_onPaneScroll");this._dims=[];this.setLayout(a.length?a[0]:new NwColumnLayout());if(OJ.isMobile()){this._multiplier=4}},_destructor:function(){this._teardown();this._super("NwScrollPane","_destructor",arguments)},_canScrollX:function(){return this._allowScroll==this._static.X||this._allowScroll==this._static.BOTH},_canScrollY:function(){return this._allowScroll==this._static.Y||this._allowScroll==this._static.BOTH},_onPaneScroll:function(a){var b=(new Date()).getTime();if(b-this._lastScroll>5){this._lastScroll=b;this.redraw()}},_onPaneScrollStart:function(a){},_onPaneScrollMove:function(a){},_onPaneScrollEnd:function(a){trace(a)},addEventListener:function(a,c,b){this._super("NwScrollPane","addEventListener",arguments);this._addItemListener(a)},removeEventListener:function(a,c,b){this._super("NwScrollPane","removeEventListener",arguments);this._removeItemListener(a)},redraw:function(){if(this._super("NwScrollPane","redraw",arguments)){var a=this.container,f=this.getScrollY(),c=this.getHeight(),e=this._layout.getVisible(new OjRect(this.getScrollX()-a.getX(),f-a.getY(),this.getWidth()*this._multiplier,c*this._multiplier)),d=a.numChildren(),b;for(;d--;){if((b=e.indexOf(this.indexOfElm(a.getChildAt(d))))==-1){a.removeChildAt(d)}else{e.splice(b,1)}}d=e.length;for(;d--;){a.addChild(this.renderItemAt(e[d]))}if(this.footer){if(f+c<this.footer.getY()){if(this._footer.parent()){}}else{this.footer.addChild(this._footer);this.footer.setHeight(OjStyleElement.AUTO)}}if(this.header){if(f>(c=this.header.getHeight())){if(this._header.parent()){this.header.setHeight(c);this.header.removeAllChildren()}}else{this.header.addChild(this._header);this.header.setHeight(OjStyleElement.AUTO)}}return true}return false},_onItemAdd:function(a){this._super("NwScrollPane","_onItemAdd",arguments);this._onItemChange(a)},_onItemChange:function(a){this._layout.recalculateLayout(a.getIndex());this.container.setHeight(this._layout.getItemRectAt(this.numElms()-1).getBottom());this.redraw()},_onItemMove:function(a){this._super("NwScrollPane","_onItemMove",arguments);this._onItemChange(a)},_onItemRemove:function(a){this._super("NwScrollPane","_onItemRemove",arguments);this._onItemChange(a)},_onItemReplace:function(a){this._super("NwScrollPane","_onItemReplace",arguments);this._onItemChange(a)},setLayout:function(a){if(this._layout==a){return}(this._layout=a).setTarget(this)}}),{_TAGS:["scrollpane"],BOTH:"x",X:"x",Y:"y"});